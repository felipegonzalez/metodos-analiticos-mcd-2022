<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 Representación de palabras y word2vec | Métodos analíticos, ITAM 2022</title>
  <meta name="description" content="Notas para métodos analíticos 2022" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="10 Representación de palabras y word2vec | Métodos analíticos, ITAM 2022" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Notas para métodos analíticos 2022" />
  <meta name="github-repo" content="felipexgonzalez/metodos-analiticos-mcd-2022" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 Representación de palabras y word2vec | Métodos analíticos, ITAM 2022" />
  
  <meta name="twitter:description" content="Notas para métodos analíticos 2022" />
  

<meta name="author" content="Felipe González" />


<meta name="date" content="2022-05-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelos-de-lenguaje-y-n-gramas.html"/>
<link rel="next" href="t-sne-y-reducción-de-dimensionalidad.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.20/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet" />
<script src="libs/vis-9.1.0/vis-network.min.js"></script>
<script src="libs/visNetwork-binding-2.1.0/visNetwork.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Métodos Analíticos</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Temario</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#evaluación"><i class="fa fa-check"></i>Evaluación</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introducción</a>
<ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#simlitud-en-dimensión-alta"><i class="fa fa-check"></i>Simlitud en dimensión alta</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#medidas-de-distancia-o-similitud"><i class="fa fa-check"></i>Medidas de distancia o similitud</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#tipos-de-soluciones"><i class="fa fa-check"></i>Tipos de soluciones</a>
<ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#proyección-y-búsqueda-de-marginales-interesantes"><i class="fa fa-check"></i>Proyección y búsqueda de marginales interesantes</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#proyecciones-globales"><i class="fa fa-check"></i>Proyecciones globales</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#descripción-de-estructura-local"><i class="fa fa-check"></i>Descripción de estructura local</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#inmersiones-embeddings"><i class="fa fa-check"></i>Inmersiones (embeddings)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="frecuentes.html"><a href="frecuentes.html"><i class="fa fa-check"></i><b>2</b> Análisis de conjuntos frecuentes</a>
<ul>
<li class="chapter" data-level="2.1" data-path="frecuentes.html"><a href="frecuentes.html#datos-de-canastas"><i class="fa fa-check"></i><b>2.1</b> Datos de canastas</a></li>
<li class="chapter" data-level="2.2" data-path="frecuentes.html"><a href="frecuentes.html#conjuntos-frecuentes"><i class="fa fa-check"></i><b>2.2</b> Conjuntos frecuentes</a></li>
<li class="chapter" data-level="2.3" data-path="frecuentes.html"><a href="frecuentes.html#monotonicidad-de-conjuntos-frecuentes"><i class="fa fa-check"></i><b>2.3</b> Monotonicidad de conjuntos frecuentes</a></li>
<li class="chapter" data-level="2.4" data-path="frecuentes.html"><a href="frecuentes.html#algoritmo-a-priori"><i class="fa fa-check"></i><b>2.4</b> Algoritmo a-priori</a></li>
<li class="chapter" data-level="2.5" data-path="frecuentes.html"><a href="frecuentes.html#modelos-simples-para-análisis-de-canastas"><i class="fa fa-check"></i><b>2.5</b> Modelos simples para análisis de canastas</a>
<ul>
<li class="chapter" data-level="" data-path="frecuentes.html"><a href="frecuentes.html#ejemplo-3"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="frecuentes.html"><a href="frecuentes.html#modelo-de-artículos-independientes"><i class="fa fa-check"></i>Modelo de artículos independientes</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="frecuentes.html"><a href="frecuentes.html#soporte-teórico-y-conjuntos-frecuentes"><i class="fa fa-check"></i><b>2.6</b> Soporte teórico y conjuntos frecuentes</a>
<ul>
<li class="chapter" data-level="" data-path="frecuentes.html"><a href="frecuentes.html#ejemplo-4"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="frecuentes.html"><a href="frecuentes.html#reglas-de-asociación"><i class="fa fa-check"></i><b>2.7</b> Reglas de asociación</a>
<ul>
<li class="chapter" data-level="" data-path="frecuentes.html"><a href="frecuentes.html#ejemplo-5"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="frecuentes.html"><a href="frecuentes.html#ejemplo-6"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="frecuentes.html"><a href="frecuentes.html#dificultades-en-el-análisis-de-canastas"><i class="fa fa-check"></i><b>2.8</b> Dificultades en el análisis de canastas</a></li>
<li class="chapter" data-level="2.9" data-path="frecuentes.html"><a href="frecuentes.html#otras-medidas-de-calidad-de-reglas"><i class="fa fa-check"></i><b>2.9</b> Otras medidas de calidad de reglas</a>
<ul>
<li class="chapter" data-level="" data-path="frecuentes.html"><a href="frecuentes.html#hyper-lift-bajo-hipótesis-de-independencia"><i class="fa fa-check"></i>Hyper-lift bajo hipótesis de independencia</a></li>
<li class="chapter" data-level="" data-path="frecuentes.html"><a href="frecuentes.html#hyper-lift-para-datos-de-canastas"><i class="fa fa-check"></i>Hyper-lift para datos de canastas</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="frecuentes.html"><a href="frecuentes.html#selección-de-reglas"><i class="fa fa-check"></i><b>2.10</b> Selección de reglas</a>
<ul>
<li class="chapter" data-level="" data-path="frecuentes.html"><a href="frecuentes.html#ejemplo-canastas-grandes"><i class="fa fa-check"></i>Ejemplo: canastas grandes</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="frecuentes.html"><a href="frecuentes.html#búsqueda-de-reglas-especializadas"><i class="fa fa-check"></i><b>2.11</b> Búsqueda de reglas especializadas</a></li>
<li class="chapter" data-level="2.12" data-path="frecuentes.html"><a href="frecuentes.html#visualización-de-asociaciones"><i class="fa fa-check"></i><b>2.12</b> Visualización de asociaciones</a>
<ul>
<li class="chapter" data-level="2.12.1" data-path="frecuentes.html"><a href="frecuentes.html#ejemplo-canastas"><i class="fa fa-check"></i><b>2.12.1</b> Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="2.13" data-path="frecuentes.html"><a href="frecuentes.html#otras-aplicaciones"><i class="fa fa-check"></i><b>2.13</b> Otras aplicaciones</a></li>
<li class="chapter" data-level="2.14" data-path="frecuentes.html"><a href="frecuentes.html#ejercicios"><i class="fa fa-check"></i><b>2.14</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="similitud.html"><a href="similitud.html"><i class="fa fa-check"></i><b>3</b> Similitud y vecinos cercanos</a>
<ul>
<li class="chapter" data-level="3.1" data-path="similitud.html"><a href="similitud.html#similitud-de-conjuntos"><i class="fa fa-check"></i><b>3.1</b> Similitud de conjuntos</a></li>
<li class="chapter" data-level="3.2" data-path="similitud.html"><a href="similitud.html#representación-de-documentos-como-conjuntos"><i class="fa fa-check"></i><b>3.2</b> Representación de documentos como conjuntos</a></li>
<li class="chapter" data-level="3.3" data-path="similitud.html"><a href="similitud.html#representación-matricial"><i class="fa fa-check"></i><b>3.3</b> Representación matricial</a></li>
<li class="chapter" data-level="3.4" data-path="similitud.html"><a href="similitud.html#minhash-y-reducción-probabilística-de-dimensionalidad"><i class="fa fa-check"></i><b>3.4</b> Minhash y reducción probabilística de dimensionalidad</a></li>
<li class="chapter" data-level="3.5" data-path="similitud.html"><a href="similitud.html#agrupando-textos-de-similitud-alta"><i class="fa fa-check"></i><b>3.5</b> Agrupando textos de similitud alta</a></li>
<li class="chapter" data-level="3.6" data-path="similitud.html"><a href="similitud.html#ejemplo-tweets"><i class="fa fa-check"></i><b>3.6</b> Ejemplo: tweets</a></li>
<li class="chapter" data-level="3.7" data-path="similitud.html"><a href="similitud.html#verificar-si-un-nuevo-elemento-es-duplicado"><i class="fa fa-check"></i><b>3.7</b> Verificar si un nuevo elemento es duplicado</a></li>
<li class="chapter" data-level="3.8" data-path="similitud.html"><a href="similitud.html#controlando-la-sensibilidad-y-umbral-de-similitud"><i class="fa fa-check"></i><b>3.8</b> Controlando la sensibilidad y umbral de similitud</a></li>
<li class="chapter" data-level="3.9" data-path="similitud.html"><a href="similitud.html#distancia-euclideana-y-lsh"><i class="fa fa-check"></i><b>3.9</b> Distancia euclideana y LSH</a></li>
<li class="chapter" data-level="3.10" data-path="similitud.html"><a href="similitud.html#locality-sensitive-hashing-lsh"><i class="fa fa-check"></i><b>3.10</b> Locality Sensitive Hashing (LSH)</a></li>
<li class="chapter" data-level="3.11" data-path="similitud.html"><a href="similitud.html#lsh-para-imágenes"><i class="fa fa-check"></i><b>3.11</b> LSH para imágenes</a></li>
<li class="chapter" data-level="3.12" data-path="similitud.html"><a href="similitud.html#joins-por-similitud"><i class="fa fa-check"></i><b>3.12</b> Joins por similitud</a></li>
<li class="chapter" data-level="3.13" data-path="similitud.html"><a href="similitud.html#ejemplo-entity-matching"><i class="fa fa-check"></i><b>3.13</b> Ejemplo: entity matching</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html"><i class="fa fa-check"></i><b>4</b> DVS y reducción de dimensionalidad</a>
<ul>
<li class="chapter" data-level="4.1" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#descomposición-aditiva-en-matrices-de-rango-1"><i class="fa fa-check"></i><b>4.1</b> Descomposición aditiva en matrices de rango 1</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#matrices-de-rango-1"><i class="fa fa-check"></i><b>4.1.1</b> Matrices de rango 1</a></li>
<li class="chapter" data-level="" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#ejemplo-una-matriz-de-rango-1-de-preferencias"><i class="fa fa-check"></i>Ejemplo: una matriz de rango 1 de preferencias</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#aproximación-con-matrices-de-rango-1."><i class="fa fa-check"></i><b>4.2</b> Aproximación con matrices de rango 1.</a>
<ul>
<li class="chapter" data-level="" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#ejemplo-12"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="4.2.1" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#suma-de-matrices-de-rango-1."><i class="fa fa-check"></i><b>4.2.1</b> Suma de matrices de rango 1.</a></li>
<li class="chapter" data-level="" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#ejemplo-películas"><i class="fa fa-check"></i>Ejemplo: películas</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#aproximación-con-matrices-de-rango-bajo"><i class="fa fa-check"></i><b>4.3</b> Aproximación con matrices de rango bajo</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#discusión-aproximación-de-rango-1."><i class="fa fa-check"></i><b>4.3.1</b> Discusión: aproximación de rango 1.</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#interpetación-de-vectores-singulares"><i class="fa fa-check"></i><b>4.4</b> Interpetación de vectores singulares</a>
<ul>
<li class="chapter" data-level="" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#ejemplo-14"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="4.4.1" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#discusión-aproximaciones-de-rango-más-alto"><i class="fa fa-check"></i><b>4.4.1</b> Discusión: aproximaciones de rango más alto</a></li>
<li class="chapter" data-level="" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#ejemplo-15"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#descomposición-en-valores-singulares-svd-o-dvs"><i class="fa fa-check"></i><b>4.5</b> Descomposición en valores singulares (SVD o DVS)</a></li>
<li class="chapter" data-level="4.6" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#más-de-interpretación-geométrica"><i class="fa fa-check"></i><b>4.6</b> Más de interpretación geométrica</a></li>
<li class="chapter" data-level="4.7" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#svd-para-películas-de-netflix"><i class="fa fa-check"></i><b>4.7</b> SVD para películas de netflix</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#calidad-de-representación-de-svd."><i class="fa fa-check"></i><b>4.7.1</b> Calidad de representación de SVD.</a></li>
<li class="chapter" data-level="" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#ejemplo-16"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#componentes-principales"><i class="fa fa-check"></i><b>4.8</b> Componentes principales</a>
<ul>
<li class="chapter" data-level="" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#varianza-en-componentes-principales"><i class="fa fa-check"></i>Varianza en componentes principales</a></li>
<li class="chapter" data-level="" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#centrar-o-no-centrar-por-columna"><i class="fa fa-check"></i>¿Centrar o no centrar por columna?</a></li>
<li class="chapter" data-level="" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#ejemplo-resultados-similares"><i class="fa fa-check"></i>Ejemplo: resultados similares</a></li>
<li class="chapter" data-level="" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#ejemplos-donde-es-buena-idea-centrar"><i class="fa fa-check"></i>Ejemplos: donde es buena idea centrar</a></li>
<li class="chapter" data-level="" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#ejemplo-donde-no-centrar-funciona-bien"><i class="fa fa-check"></i>Ejemplo: donde no centrar funciona bien</a></li>
<li class="chapter" data-level="" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#otros-tipos-de-centrado"><i class="fa fa-check"></i>Otros tipos de centrado</a></li>
<li class="chapter" data-level="" data-path="dvs-y-reducción-de-dimensionalidad.html"><a href="dvs-y-reducción-de-dimensionalidad.html#reescalando-variables"><i class="fa fa-check"></i>Reescalando variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sistemas-de-recomendación-y-filtrado-colaborativo.html"><a href="sistemas-de-recomendación-y-filtrado-colaborativo.html"><i class="fa fa-check"></i><b>5</b> Sistemas de recomendación y filtrado colaborativo</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sistemas-de-recomendación-y-filtrado-colaborativo.html"><a href="sistemas-de-recomendación-y-filtrado-colaborativo.html#enfoques-de-recomendación"><i class="fa fa-check"></i><b>5.1</b> Enfoques de recomendación</a></li>
<li class="chapter" data-level="5.2" data-path="sistemas-de-recomendación-y-filtrado-colaborativo.html"><a href="sistemas-de-recomendación-y-filtrado-colaborativo.html#datos"><i class="fa fa-check"></i><b>5.2</b> Datos</a>
<ul>
<li class="chapter" data-level="" data-path="sistemas-de-recomendación-y-filtrado-colaborativo.html"><a href="sistemas-de-recomendación-y-filtrado-colaborativo.html#ejemplo-18"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="sistemas-de-recomendación-y-filtrado-colaborativo.html"><a href="sistemas-de-recomendación-y-filtrado-colaborativo.html#modelos-de-referencia-y-evaluación"><i class="fa fa-check"></i><b>5.3</b> Modelos de referencia y evaluación</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="sistemas-de-recomendación-y-filtrado-colaborativo.html"><a href="sistemas-de-recomendación-y-filtrado-colaborativo.html#evaluación-de-predicciones"><i class="fa fa-check"></i><b>5.3.1</b> Evaluación de predicciones</a></li>
<li class="chapter" data-level="" data-path="sistemas-de-recomendación-y-filtrado-colaborativo.html"><a href="sistemas-de-recomendación-y-filtrado-colaborativo.html#ejemplo-datos-de-netflix"><i class="fa fa-check"></i>Ejemplo: datos de Netflix</a></li>
<li class="chapter" data-level="5.3.2" data-path="sistemas-de-recomendación-y-filtrado-colaborativo.html"><a href="sistemas-de-recomendación-y-filtrado-colaborativo.html#opcional-efectos-en-análisis-de-heterogeneidad-en-uso-de-escala"><i class="fa fa-check"></i><b>5.3.2</b> (Opcional) Efectos en análisis de heterogeneidad en uso de escala</a></li>
<li class="chapter" data-level="5.3.3" data-path="frecuentes.html"><a href="frecuentes.html#ejemplo"><i class="fa fa-check"></i><b>5.3.3</b> Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="sistemas-de-recomendación-y-filtrado-colaborativo.html"><a href="sistemas-de-recomendación-y-filtrado-colaborativo.html#modelo-de-referencia"><i class="fa fa-check"></i><b>5.4</b> Modelo de referencia</a>
<ul>
<li class="chapter" data-level="" data-path="sistemas-de-recomendación-y-filtrado-colaborativo.html"><a href="sistemas-de-recomendación-y-filtrado-colaborativo.html#ejercicio-modelo-de-referencia-para-netflix"><i class="fa fa-check"></i>Ejercicio: modelo de referencia para Netflix</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="sistemas-de-recomendación-y-filtrado-colaborativo.html"><a href="sistemas-de-recomendación-y-filtrado-colaborativo.html#filtrado-colaborativo-similitud"><i class="fa fa-check"></i><b>5.5</b> Filtrado colaborativo: similitud</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="sistemas-de-recomendación-y-filtrado-colaborativo.html"><a href="sistemas-de-recomendación-y-filtrado-colaborativo.html#simitems"><i class="fa fa-check"></i><b>5.5.1</b> Cálculo de similitud entre usuarios/películas</a></li>
<li class="chapter" data-level="" data-path="sistemas-de-recomendación-y-filtrado-colaborativo.html"><a href="sistemas-de-recomendación-y-filtrado-colaborativo.html#ejemplo-19"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="sistemas-de-recomendación-y-filtrado-colaborativo.html"><a href="sistemas-de-recomendación-y-filtrado-colaborativo.html#ejemplo-cómo-se-ven-las-calificaciones-de-películas-similaresno-similares"><i class="fa fa-check"></i>Ejemplo: ¿cómo se ven las calificaciones de películas similares/no similares?</a></li>
<li class="chapter" data-level="" data-path="sistemas-de-recomendación-y-filtrado-colaborativo.html"><a href="sistemas-de-recomendación-y-filtrado-colaborativo.html#ejercicio-4"><i class="fa fa-check"></i>Ejercicio</a></li>
<li class="chapter" data-level="5.5.2" data-path="sistemas-de-recomendación-y-filtrado-colaborativo.html"><a href="sistemas-de-recomendación-y-filtrado-colaborativo.html#implementación"><i class="fa fa-check"></i><b>5.5.2</b> Implementación</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dimensiones-latentes-para-recomendación.html"><a href="dimensiones-latentes-para-recomendación.html"><i class="fa fa-check"></i><b>6</b> Dimensiones latentes para recomendación</a>
<ul>
<li class="chapter" data-level="6.0.1" data-path="frecuentes.html"><a href="frecuentes.html#ejemplo"><i class="fa fa-check"></i><b>6.0.1</b> Ejemplo: una dimensión latente</a></li>
<li class="chapter" data-level="6.0.2" data-path="frecuentes.html"><a href="frecuentes.html#ejemplo"><i class="fa fa-check"></i><b>6.0.2</b> Ejemplo: dos dimensiones latentes</a></li>
<li class="chapter" data-level="6.0.3" data-path="dimensiones-latentes-para-recomendación.html"><a href="dimensiones-latentes-para-recomendación.html#combinación-con-modelo-base"><i class="fa fa-check"></i><b>6.0.3</b> Combinación con modelo base</a></li>
<li class="chapter" data-level="6.1" data-path="dimensiones-latentes-para-recomendación.html"><a href="dimensiones-latentes-para-recomendación.html#factorización-de-matrices"><i class="fa fa-check"></i><b>6.1</b> Factorización de matrices</a></li>
<li class="chapter" data-level="6.2" data-path="dimensiones-latentes-para-recomendación.html"><a href="dimensiones-latentes-para-recomendación.html#mínimos-cuadrados-alternados"><i class="fa fa-check"></i><b>6.2</b> Mínimos cuadrados alternados</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="dimensiones-latentes-para-recomendación.html"><a href="dimensiones-latentes-para-recomendación.html#mínimos-cuadrados-alternados-con-regularización"><i class="fa fa-check"></i><b>6.2.1</b> Mínimos cuadrados alternados con regularización</a></li>
<li class="chapter" data-level="" data-path="dimensiones-latentes-para-recomendación.html"><a href="dimensiones-latentes-para-recomendación.html#ejercicio-5"><i class="fa fa-check"></i>Ejercicio</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="dimensiones-latentes-para-recomendación.html"><a href="dimensiones-latentes-para-recomendación.html#retroalimentación-implícita"><i class="fa fa-check"></i><b>6.3</b> Retroalimentación implícita</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="dimensiones-latentes-para-recomendación.html"><a href="dimensiones-latentes-para-recomendación.html#ejemplo-20"><i class="fa fa-check"></i><b>6.3.1</b> Ejemplo</a></li>
<li class="chapter" data-level="6.3.2" data-path="dimensiones-latentes-para-recomendación.html"><a href="dimensiones-latentes-para-recomendación.html#ejemplo-21"><i class="fa fa-check"></i><b>6.3.2</b> Ejemplo</a></li>
<li class="chapter" data-level="6.3.3" data-path="dimensiones-latentes-para-recomendación.html"><a href="dimensiones-latentes-para-recomendación.html#evaluación-para-modelos-implícitos"><i class="fa fa-check"></i><b>6.3.3</b> Evaluación para modelos implícitos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="pagerank-y-análisis-de-redes.html"><a href="pagerank-y-análisis-de-redes.html"><i class="fa fa-check"></i><b>7</b> Pagerank y análisis de redes</a>
<ul>
<li class="chapter" data-level="7.1" data-path="pagerank-y-análisis-de-redes.html"><a href="pagerank-y-análisis-de-redes.html#introducción"><i class="fa fa-check"></i><b>7.1</b> Introducción</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="pagerank-y-análisis-de-redes.html"><a href="pagerank-y-análisis-de-redes.html#centralidad-en-redes"><i class="fa fa-check"></i><b>7.1.1</b> Centralidad en redes</a></li>
<li class="chapter" data-level="" data-path="pagerank-y-análisis-de-redes.html"><a href="pagerank-y-análisis-de-redes.html#ejemplo-de-moviegalaxies.com-pulp-fiction"><i class="fa fa-check"></i>Ejemplo de Moviegalaxies.com: Pulp Fiction</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="pagerank-y-análisis-de-redes.html"><a href="pagerank-y-análisis-de-redes.html#tipos-de-redes-y-su-representación"><i class="fa fa-check"></i><b>7.2</b> Tipos de redes y su representación</a></li>
<li class="chapter" data-level="7.3" data-path="pagerank-y-análisis-de-redes.html"><a href="pagerank-y-análisis-de-redes.html#visualización-de-redes"><i class="fa fa-check"></i><b>7.3</b> Visualización de redes</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="pagerank-y-análisis-de-redes.html"><a href="pagerank-y-análisis-de-redes.html#ejercicio-6"><i class="fa fa-check"></i><b>7.3.1</b> Ejercicio</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="pagerank-y-análisis-de-redes.html"><a href="pagerank-y-análisis-de-redes.html#medidas-de-centralidad-para-redes"><i class="fa fa-check"></i><b>7.4</b> Medidas de centralidad para redes</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="pagerank-y-análisis-de-redes.html"><a href="pagerank-y-análisis-de-redes.html#grado"><i class="fa fa-check"></i><b>7.4.1</b> Grado</a></li>
<li class="chapter" data-level="7.4.2" data-path="pagerank-y-análisis-de-redes.html"><a href="pagerank-y-análisis-de-redes.html#medida-de-centralidad-betweeness-o-intermediación"><i class="fa fa-check"></i><b>7.4.2</b> Medida de centralidad: <em>Betweeness</em> o <em>Intermediación</em></a></li>
<li class="chapter" data-level="7.4.3" data-path="pagerank-y-análisis-de-redes.html"><a href="pagerank-y-análisis-de-redes.html#medida-de-centralidad-cercanía"><i class="fa fa-check"></i><b>7.4.3</b> Medida de centralidad: Cercanía</a></li>
<li class="chapter" data-level="7.4.4" data-path="pagerank-y-análisis-de-redes.html"><a href="pagerank-y-análisis-de-redes.html#centralidad-de-eigenvector"><i class="fa fa-check"></i><b>7.4.4</b> Centralidad de eigenvector</a></li>
<li class="chapter" data-level="" data-path="pagerank-y-análisis-de-redes.html"><a href="pagerank-y-análisis-de-redes.html#matrices-irreducibles-y-gráficas-fuertemente-conexas"><i class="fa fa-check"></i>Matrices irreducibles y gráficas fuertemente conexas</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="pagerank-y-análisis-de-redes.html"><a href="pagerank-y-análisis-de-redes.html#gráficas-dirigidas"><i class="fa fa-check"></i><b>7.5</b> Gráficas dirigidas</a>
<ul>
<li><a href="pagerank-y-análisis-de-redes.html#ejemplos-qué-pasa-si-a-es-no-reducible">Ejemplos: ¿qué pasa si <span class="math inline">\(A\)</span> es no reducible?</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="pagerank-y-análisis-de-redes.html"><a href="pagerank-y-análisis-de-redes.html#pagerank"><i class="fa fa-check"></i><b>7.6</b> Pagerank</a>
<ul>
<li class="chapter" data-level="" data-path="pagerank-y-análisis-de-redes.html"><a href="pagerank-y-análisis-de-redes.html#ejemplo-24"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="7.6.1" data-path="pagerank-y-análisis-de-redes.html"><a href="pagerank-y-análisis-de-redes.html#la-matriz-m-es-estocástica"><i class="fa fa-check"></i><b>7.6.1</b> La matriz <span class="math inline">\(M\)</span> es estocástica</a></li>
<li class="chapter" data-level="7.6.2" data-path="pagerank-y-análisis-de-redes.html"><a href="pagerank-y-análisis-de-redes.html#primeras-dificultades"><i class="fa fa-check"></i><b>7.6.2</b> Primeras dificultades</a></li>
<li class="chapter" data-level="7.6.3" data-path="pagerank-y-análisis-de-redes.html"><a href="pagerank-y-análisis-de-redes.html#el-proceso-estocástico-cadena-de-markov-asociado-al-pagerank-versión-simple"><i class="fa fa-check"></i><b>7.6.3</b> El proceso estocástico (cadena de Markov) asociado al Pagerank, versión simple</a></li>
<li class="chapter" data-level="7.6.4" data-path="pagerank-y-análisis-de-redes.html"><a href="pagerank-y-análisis-de-redes.html#matriz-de-transición"><i class="fa fa-check"></i><b>7.6.4</b> Matriz de transición</a></li>
<li class="chapter" data-level="7.6.5" data-path="pagerank-y-análisis-de-redes.html"><a href="pagerank-y-análisis-de-redes.html#distribución-de-equilibrio-versión-simple"><i class="fa fa-check"></i><b>7.6.5</b> Distribución de equilibrio (versión simple)</a></li>
<li class="chapter" data-level="7.6.6" data-path="pagerank-y-análisis-de-redes.html"><a href="pagerank-y-análisis-de-redes.html#distribución-de-equilibrio-y-probabilidades-a-largo-plazo"><i class="fa fa-check"></i><b>7.6.6</b> Distribución de equilibrio y probabilidades a largo plazo</a></li>
<li class="chapter" data-level="7.6.7" data-path="pagerank-y-análisis-de-redes.html"><a href="pagerank-y-análisis-de-redes.html#matriz-de-transición-a-k-pasos"><i class="fa fa-check"></i><b>7.6.7</b> Matriz de transición a <span class="math inline">\(k\)</span> pasos</a></li>
<li class="chapter" data-level="7.6.8" data-path="pagerank-y-análisis-de-redes.html"><a href="pagerank-y-análisis-de-redes.html#pagerank-teletransportaciónperturbación-de-la-matriz-m"><i class="fa fa-check"></i><b>7.6.8</b> Pagerank: teletransportación/perturbación de la matriz <span class="math inline">\(M\)</span></a></li>
<li class="chapter" data-level="7.6.9" data-path="pagerank-y-análisis-de-redes.html"><a href="pagerank-y-análisis-de-redes.html#pagerank-para-buscador"><i class="fa fa-check"></i><b>7.6.9</b> Pagerank para buscador</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="detección-de-comunidades.html"><a href="detección-de-comunidades.html"><i class="fa fa-check"></i><b>8</b> Detección de comunidades</a>
<ul>
<li class="chapter" data-level="8.1" data-path="detección-de-comunidades.html"><a href="detección-de-comunidades.html#modularidad"><i class="fa fa-check"></i><b>8.1</b> Modularidad</a></li>
<li class="chapter" data-level="8.2" data-path="detección-de-comunidades.html"><a href="detección-de-comunidades.html#algoritmo-miope-fast-greedy"><i class="fa fa-check"></i><b>8.2</b> Algoritmo miope (fast greedy)</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modelos-de-lenguaje-y-n-gramas.html"><a href="modelos-de-lenguaje-y-n-gramas.html"><i class="fa fa-check"></i><b>9</b> Modelos de lenguaje y n-gramas</a>
<ul>
<li class="chapter" data-level="9.1" data-path="modelos-de-lenguaje-y-n-gramas.html"><a href="modelos-de-lenguaje-y-n-gramas.html#ejemplo-modelo-de-canal-ruidoso"><i class="fa fa-check"></i><b>9.1</b> Ejemplo: Modelo de canal ruidoso</a></li>
<li class="chapter" data-level="9.2" data-path="modelos-de-lenguaje-y-n-gramas.html"><a href="modelos-de-lenguaje-y-n-gramas.html#corpus-y-vocabulario"><i class="fa fa-check"></i><b>9.2</b> Corpus y vocabulario</a></li>
<li class="chapter" data-level="9.3" data-path="modelos-de-lenguaje-y-n-gramas.html"><a href="modelos-de-lenguaje-y-n-gramas.html#modelos-de-lenguaje-n-gramas"><i class="fa fa-check"></i><b>9.3</b> Modelos de lenguaje: n-gramas</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="modelos-de-lenguaje-y-n-gramas.html"><a href="modelos-de-lenguaje-y-n-gramas.html#modelo-generativo-de-n-gramas"><i class="fa fa-check"></i><b>9.3.1</b> Modelo generativo de n-gramas</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="modelos-de-lenguaje-y-n-gramas.html"><a href="modelos-de-lenguaje-y-n-gramas.html#modelo-de-n-gramas-usando-conteos"><i class="fa fa-check"></i><b>9.4</b> Modelo de n-gramas usando conteos</a></li>
<li class="chapter" data-level="9.5" data-path="modelos-de-lenguaje-y-n-gramas.html"><a href="modelos-de-lenguaje-y-n-gramas.html#notas-de-periódico-modelo-de-n-gramas-simples."><i class="fa fa-check"></i><b>9.5</b> Notas de periódico: modelo de n-gramas simples.</a>
<ul>
<li class="chapter" data-level="" data-path="modelos-de-lenguaje-y-n-gramas.html"><a href="modelos-de-lenguaje-y-n-gramas.html#problema-de-los-ceros"><i class="fa fa-check"></i>Problema de los ceros</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="modelos-de-lenguaje-y-n-gramas.html"><a href="modelos-de-lenguaje-y-n-gramas.html#evaluación-de-modelos"><i class="fa fa-check"></i><b>9.6</b> Evaluación de modelos</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="modelos-de-lenguaje-y-n-gramas.html"><a href="modelos-de-lenguaje-y-n-gramas.html#generación-de-texto"><i class="fa fa-check"></i><b>9.6.1</b> Generación de texto</a></li>
<li class="chapter" data-level="9.6.2" data-path="modelos-de-lenguaje-y-n-gramas.html"><a href="modelos-de-lenguaje-y-n-gramas.html#evaluación-de-modelos-perplejidad"><i class="fa fa-check"></i><b>9.6.2</b> Evaluación de modelos: perplejidad</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="modelos-de-lenguaje-y-n-gramas.html"><a href="modelos-de-lenguaje-y-n-gramas.html#suavizamiento-de-conteos-otros-métodos"><i class="fa fa-check"></i><b>9.7</b> Suavizamiento de conteos: otros métodos</a>
<ul>
<li class="chapter" data-level="" data-path="modelos-de-lenguaje-y-n-gramas.html"><a href="modelos-de-lenguaje-y-n-gramas.html#desempeño"><i class="fa fa-check"></i>Desempeño</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="modelos-de-lenguaje-y-n-gramas.html"><a href="modelos-de-lenguaje-y-n-gramas.html#ejemplo-corrector-de-ortografía"><i class="fa fa-check"></i><b>9.8</b> Ejemplo: Corrector de ortografía</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="representación-de-palabras-y-word2vec.html"><a href="representación-de-palabras-y-word2vec.html"><i class="fa fa-check"></i><b>10</b> Representación de palabras y word2vec</a>
<ul>
<li class="chapter" data-level="10.1" data-path="representación-de-palabras-y-word2vec.html"><a href="representación-de-palabras-y-word2vec.html#modelo-de-red-neuronal"><i class="fa fa-check"></i><b>10.1</b> Modelo de red neuronal</a>
<ul>
<li class="chapter" data-level="" data-path="representación-de-palabras-y-word2vec.html"><a href="representación-de-palabras-y-word2vec.html#ejemplo-32"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="representación-de-palabras-y-word2vec.html"><a href="representación-de-palabras-y-word2vec.html#representación-de-palabras"><i class="fa fa-check"></i><b>10.2</b> Representación de palabras</a></li>
<li class="chapter" data-level="10.3" data-path="representación-de-palabras-y-word2vec.html"><a href="representación-de-palabras-y-word2vec.html#modelos-de-word2vec"><i class="fa fa-check"></i><b>10.3</b> Modelos de word2vec</a>
<ul>
<li class="chapter" data-level="" data-path="representación-de-palabras-y-word2vec.html"><a href="representación-de-palabras-y-word2vec.html#arquitectura-continuous-bag-of-words"><i class="fa fa-check"></i>Arquitectura continuous bag-of-words</a></li>
<li class="chapter" data-level="" data-path="representación-de-palabras-y-word2vec.html"><a href="representación-de-palabras-y-word2vec.html#arquitectura-skip-grams"><i class="fa fa-check"></i>Arquitectura skip-grams</a></li>
<li class="chapter" data-level="" data-path="representación-de-palabras-y-word2vec.html"><a href="representación-de-palabras-y-word2vec.html#muestreo-negativo"><i class="fa fa-check"></i>Muestreo negativo</a></li>
<li class="chapter" data-level="" data-path="representación-de-palabras-y-word2vec.html"><a href="representación-de-palabras-y-word2vec.html#ejemplo-33"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="representación-de-palabras-y-word2vec.html"><a href="representación-de-palabras-y-word2vec.html#esprep"><i class="fa fa-check"></i><b>10.4</b> Espacio de representación de palabras</a>
<ul>
<li class="chapter" data-level="" data-path="representación-de-palabras-y-word2vec.html"><a href="representación-de-palabras-y-word2vec.html#geometría-en-el-espacio-de-representaciones"><i class="fa fa-check"></i>Geometría en el espacio de representaciones</a></li>
<li class="chapter" data-level="" data-path="representación-de-palabras-y-word2vec.html"><a href="representación-de-palabras-y-word2vec.html#geometría-en-el-espacio-de-representaciones-1"><i class="fa fa-check"></i>Geometría en el espacio de representaciones</a></li>
<li class="chapter" data-level="" data-path="representación-de-palabras-y-word2vec.html"><a href="representación-de-palabras-y-word2vec.html#evaluación-de-calidad-de-modelos"><i class="fa fa-check"></i>Evaluación de calidad de modelos</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="representación-de-palabras-y-word2vec.html"><a href="representación-de-palabras-y-word2vec.html#usos-de-representaciones-distribuidas"><i class="fa fa-check"></i><b>10.5</b> Usos de representaciones distribuidas</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="t-sne-y-reducción-de-dimensionalidad.html"><a href="t-sne-y-reducción-de-dimensionalidad.html"><i class="fa fa-check"></i><b>11</b> t-SNE y reducción de dimensionalidad</a>
<ul>
<li class="chapter" data-level="" data-path="t-sne-y-reducción-de-dimensionalidad.html"><a href="t-sne-y-reducción-de-dimensionalidad.html#ejemplo-34"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="11.0.1" data-path="t-sne-y-reducción-de-dimensionalidad.html"><a href="t-sne-y-reducción-de-dimensionalidad.html#sne"><i class="fa fa-check"></i><b>11.0.1</b> SNE</a></li>
<li class="chapter" data-level="11.0.2" data-path="t-sne-y-reducción-de-dimensionalidad.html"><a href="t-sne-y-reducción-de-dimensionalidad.html#minimización-para-sne"><i class="fa fa-check"></i><b>11.0.2</b> Minimización para SNE</a></li>
<li class="chapter" data-level="" data-path="t-sne-y-reducción-de-dimensionalidad.html"><a href="t-sne-y-reducción-de-dimensionalidad.html#ejemplo-35"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="experimentación-y-algoritmos-de-tragamonedas-bandits.html"><a href="experimentación-y-algoritmos-de-tragamonedas-bandits.html"><i class="fa fa-check"></i><b>12</b> Experimentación y algoritmos de tragamonedas (bandits)</a>
<ul>
<li class="chapter" data-level="12.1" data-path="experimentación-y-algoritmos-de-tragamonedas-bandits.html"><a href="experimentación-y-algoritmos-de-tragamonedas-bandits.html#causalidad-y-contrafactuales"><i class="fa fa-check"></i><b>12.1</b> Causalidad y contrafactuales</a></li>
<li class="chapter" data-level="12.2" data-path="experimentación-y-algoritmos-de-tragamonedas-bandits.html"><a href="experimentación-y-algoritmos-de-tragamonedas-bandits.html#experimentos-ab"><i class="fa fa-check"></i><b>12.2</b> Experimentos A/B</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="experimentación-y-algoritmos-de-tragamonedas-bandits.html"><a href="experimentación-y-algoritmos-de-tragamonedas-bandits.html#aleatorización-en-experimentos."><i class="fa fa-check"></i><b>12.2.1</b> Aleatorización en experimentos.</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="experimentación-y-algoritmos-de-tragamonedas-bandits.html"><a href="experimentación-y-algoritmos-de-tragamonedas-bandits.html#costos-de-experimentación"><i class="fa fa-check"></i><b>12.3</b> Costos de experimentación</a></li>
<li class="chapter" data-level="12.4" data-path="experimentación-y-algoritmos-de-tragamonedas-bandits.html"><a href="experimentación-y-algoritmos-de-tragamonedas-bandits.html#algoritmos-de-tragamonedas"><i class="fa fa-check"></i><b>12.4</b> Algoritmos de tragamonedas</a></li>
<li class="chapter" data-level="12.5" data-path="experimentación-y-algoritmos-de-tragamonedas-bandits.html"><a href="experimentación-y-algoritmos-de-tragamonedas-bandits.html#algoritmo-epsilon-miope"><i class="fa fa-check"></i><b>12.5</b> Algoritmo epsilon-miope</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="experimentación-y-algoritmos-de-tragamonedas-bandits.html"><a href="experimentación-y-algoritmos-de-tragamonedas-bandits.html#comparación-con-experimentación-clásica"><i class="fa fa-check"></i><b>12.5.1</b> Comparación con experimentación clásica</a></li>
<li class="chapter" data-level="" data-path="experimentación-y-algoritmos-de-tragamonedas-bandits.html"><a href="experimentación-y-algoritmos-de-tragamonedas-bandits.html#desventajas-del-algoritmo-miope"><i class="fa fa-check"></i>Desventajas del algoritmo miope</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="experimentación-y-algoritmos-de-tragamonedas-bandits.html"><a href="experimentación-y-algoritmos-de-tragamonedas-bandits.html#algoritmo-softmax"><i class="fa fa-check"></i><b>12.6</b> Algoritmo softmax</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="experimentación-y-algoritmos-de-tragamonedas-bandits.html"><a href="experimentación-y-algoritmos-de-tragamonedas-bandits.html#desventajas-del-algoritmo-softmax"><i class="fa fa-check"></i><b>12.6.1</b> Desventajas del algoritmo softmax</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="experimentación-y-algoritmos-de-tragamonedas-bandits.html"><a href="experimentación-y-algoritmos-de-tragamonedas-bandits.html#el-algoritmo-de-cota-superior-de-confianza-ucb"><i class="fa fa-check"></i><b>12.7</b> El algoritmo de cota superior de confianza (UCB)</a></li>
<li class="chapter" data-level="12.8" data-path="experimentación-y-algoritmos-de-tragamonedas-bandits.html"><a href="experimentación-y-algoritmos-de-tragamonedas-bandits.html#tragamonedas-bayesianos"><i class="fa fa-check"></i><b>12.8</b> Tragamonedas bayesianos</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="experimentación-y-algoritmos-de-tragamonedas-bandits.html"><a href="experimentación-y-algoritmos-de-tragamonedas-bandits.html#ejemplo-bernoulli"><i class="fa fa-check"></i><b>12.8.1</b> Ejemplo bernoulli</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="experimentación-y-algoritmos-de-tragamonedas-bandits.html"><a href="experimentación-y-algoritmos-de-tragamonedas-bandits.html#otros-aspectos-de-la-experimentación-y-máquinas-tragamonedas"><i class="fa fa-check"></i><b>12.9</b> Otros aspectos de la experimentación y máquinas tragamonedas</a>
<ul>
<li class="chapter" data-level="" data-path="experimentación-y-algoritmos-de-tragamonedas-bandits.html"><a href="experimentación-y-algoritmos-de-tragamonedas-bandits.html#pruebas-aa"><i class="fa fa-check"></i>Pruebas A/A</a></li>
<li class="chapter" data-level="" data-path="experimentación-y-algoritmos-de-tragamonedas-bandits.html"><a href="experimentación-y-algoritmos-de-tragamonedas-bandits.html#métricas-de-éxito-defectuosas"><i class="fa fa-check"></i>Métricas de éxito defectuosas</a></li>
<li class="chapter" data-level="12.9.1" data-path="experimentación-y-algoritmos-de-tragamonedas-bandits.html"><a href="experimentación-y-algoritmos-de-tragamonedas-bandits.html#tragamonedas-contextuales"><i class="fa fa-check"></i><b>12.9.1</b> Tragamonedas contextuales</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/felipegonzalez/metodos-analiticos-mcd-2022" target="blank">Repositorio de Github</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Métodos analíticos, ITAM 2022</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="representación-de-palabras-y-word2vec" class="section level1" number="10">
<h1><span class="header-section-number">10</span> Representación de palabras y word2vec</h1>
<p>En esta parte empezamos a ver los enfoques más modernos (redes neuronales) para construir
modelos de lenguajes y resolver tareas de NLP. Se trata de modelos de lenguaje que incluyen más
estructura, son más fáciles de regularizar y de ampliar si es necesario para incluir
dependencias de mayor distancia. El método de conteo/suavizamiento de ngramas es simple y funciona
bien para algunas tareas, pero podemos construir mejores modelos con enfoques más estructurados, y con
más capacidad para aprender aspectos más complejos del lenguaje natural.</p>
<p>Si <span class="math inline">\(w=w_1w_2\cdots w_N\)</span> es una frase, y las <span class="math inline">\(w\)</span> representan palabras, recordemos que un modelo de lenguaje con dependencia de <span class="math inline">\(n\)</span>-gramas consiste de las probabilidades</p>
<p><span class="math display">\[P(w_t | w_{t-1} w_{t-2} \cdots w_{t-n+1}),\]</span></p>
<p>(n=2, bigramas, n=3 trigramas, etc.)</p>
<p>Y vimos que tenemos problemas cuando observamos sucesiones que no vimos en el corpus de entrenamiento. Este problema se puede “parchar” utilizando técnicas de suavizamiento. Aún para colecciones de entrenamiento muy grandes tenemos que lidiar con este problema.</p>
<p>Podemos tomar un enfoque más estructurado pensando en representaciones “distribucionales” de palabras:</p>
<ol style="list-style-type: decimal">
<li>Asociamos a cada palabra en el vocabulario un vector numérico con <span class="math inline">\(d\)</span> dimensiones, que es su <em>representación distribuida</em>.</li>
<li>Expresamos la función de probabilidad como combinaciones de
las representaciones vectoriales del primer paso.</li>
<li>Aprendemos (máxima verosimiltud posiblemente regularización) simultáneamente los vectores y la manera de combinar
estos vectores para producir probabilidades.</li>
</ol>
<p>La idea de este modelo es entonces subsanar la relativa escasez de datos (comparado con todos los trigramas que pueden existir) con estructura. Sabemos que esta es una buena estrategia si la estrucutura impuesta es apropiada.</p>

<div class="resumen">
Una de las ideas fundamentales de este enfoque es representar
a cada palabra como un vector numérico de dimensión <span class="math inline">\(d\)</span>. Esto
se llama una <em>representación vectorial distribuida</em>, o también
un <em>embedding de palabras</em>.
</div>
<p>El objeto es entonces abstraer características de palabras (mediante estas representaciones)
intentando no perder mucho de su sentido
original, lo que nos permite conocer palabras por su contexto, aún cuando no las hayamos observado antes.</p>
<div id="ejemplo-31" class="section level4 unnumbered">
<h4>Ejemplo</h4>
<p>¿Cómo puede funcionar este enfoque? Por ejemplo, si vemos la frase “El gato corre en el jardín,” sabemos que una frase probable debe ser también “El perro corre en el jardín,” pero quizá nunca vimos en el corpus la sucesión “El perro corre.” La idea es que como “perro” y “gato” son funcionalmente similares (aparecen en contextos similares en otros tipos de oraciones como el perro come, el gato come, el perro duerme, este es mi gato, etc.), un modelo como el de arriba daría vectores similares a “perro” y “gato,” pues aparecen en contextos similares. Entonces el modelo daría una probabilidad alta a “El perro corre en el jardín.”</p>
</div>
<div id="modelo-de-red-neuronal" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Modelo de red neuronal</h2>
<p>Podemos entonces construir una red neuronal con 2 capas ocultas como sigue (segimos <span class="citation">(<a href="#ref-bengio" role="doc-biblioref">Bengio et al. 2003</a>)</span>, una de
las primeras referencias en usar este enfoque). Usemos el ejemplo de trigramas:</p>
<ol style="list-style-type: decimal">
<li><strong>Capa de incrustación o embedding</strong>. En la primera capa oculta, tenemos un mapeo de las entradas <span class="math inline">\(w_1,\ldots, w_{n-1}\)</span> a <span class="math inline">\(x=C(w_1),\ldots, C(w_{n-1})\)</span>, donde <span class="math inline">\(C\)</span> es una función que mapea palabras a vectores de dimensión <span class="math inline">\(d\)</span>. <span class="math inline">\(C\)</span> también se puede pensar como una matriz de dimensión <span class="math inline">\(|V|\)</span> por <span class="math inline">\(d\)</span>. En la capa de entrada,</li>
</ol>
<p><span class="math display">\[w_{n-2},w_{n-1} \to x = (C(w_{n-2}), C(w_{n-1})).\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li><strong>Capa totalmente conexa</strong>. En la siguiente capa oculta tenemos una matriz de pesos <span class="math inline">\(H\)</span> y la función logística (o tangente hiperbólica) <span class="math inline">\(\sigma (z) = \frac{e^z}{1+e^z}\)</span>, como en una red neuronal usual.</li>
</ol>
<p>En esta capa calculamos
<span class="math display">\[z = \sigma (a + Hx),\]</span>
que resulta en un vector de tamaño <span class="math inline">\(h\)</span>.</p>
<ol start="3" style="list-style-type: decimal">
<li>La <strong>capa de salida</strong> debe ser un vector de probabilidades
sobre todo el vocabulario <span class="math inline">\(|V|\)</span>. En esta capa tenemos pesos <span class="math inline">\(U\)</span> y hacemos
<span class="math display">\[y = b + U\sigma (z),\]</span>
y finalmente usamos softmax para tener probabilidades que suman uno:
<span class="math display">\[p_i = \frac{\exp (y_i) }{\sum_j exp(y_j)}.\]</span></li>
</ol>
<p>En el ajuste maximizamos la verosimilitud:</p>
<p><span class="math display">\[\sum_t \log \hat{P}(w_{t,n}|w_{t,n-2}w_{t-n-1}) \]</span></p>
<p>La representación en la referencia <span class="citation">(<a href="#ref-bengio" role="doc-biblioref">Bengio et al. 2003</a>)</span> es:</p>
<div class="figure">
<img src="images/1_neural_model.png" alt="" />
<p class="caption">Imagen</p>
</div>
<p>Esta idea original ha sido explotada con éxito, aunque sigue siendo
intensivo en cómputo ajustar un modelo como este. Nótese que
el número de parámetros es del orden de <span class="math inline">\(|V|(nm+h)\)</span>, donde <span class="math inline">\(|V|\)</span> es el tamaño del vocabulario (decenas o cientos de miles), <span class="math inline">\(n\)</span> es 3 o 4 (trigramas, 4-gramas), <span class="math inline">\(m\)</span> es el tamaño de la representacion (cientos) y <span class="math inline">\(h\)</span> es el número de nodos en la segunda capa (también cientos o miles). Esto resulta en el mejor de los casos en modelos con miles de millones de parámetros. Adicionalmente, hay algunos cálculos costosos, como el softmax (donde hay que hacer una suma sobre el vocabulario completo). En el paper original se propone <strong>descenso estocástico</strong>.</p>
<div id="ejemplo-32" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>Veamos un ejemplo chico de cómo se vería el paso
feed-forward de esta red. Supondremos en este
ejemplo que los sesgos <span class="math inline">\(a,b\)</span> son
iguales a cero para simplificar los cálculos.</p>
<p>Consideremos que el texto de entrenamiento es
“El perro corre. El gato corre. El león corre. El león ruge.”</p>
<p>En este caso, nuestro vocabulario consiste de los 8 tokens
<span class="math inline">\(&lt;s&gt;\)</span>, el, perro, gato, león, corre, caza <span class="math inline">\(&lt;/s&gt;\)</span>. Consideremos un
modelo con <span class="math inline">\(d=2\)</span> (representaciones de palabras en 2 dimensiones),
y consideramos un modelo de trigramas.</p>
<p>Nuestra primera capa es una matriz <span class="math inline">\(C\)</span> de tamaño <span class="math inline">\(2\times 8\)</span>,
es decir, un vector de tamaño 2 para cada palabra. Por ejemplo,
podríamos tener</p>
<div class="sourceCode" id="cb846"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb846-1"><a href="representación-de-palabras-y-word2vec.html#cb846-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb846-2"><a href="representación-de-palabras-y-word2vec.html#cb846-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">63</span>)</span>
<span id="cb846-3"><a href="representación-de-palabras-y-word2vec.html#cb846-3" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">16</span>, <span class="dv">0</span>, <span class="fl">0.1</span>), <span class="dv">2</span>, <span class="dv">8</span>), <span class="dv">2</span>)</span>
<span id="cb846-4"><a href="representación-de-palabras-y-word2vec.html#cb846-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(C) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;_s_&quot;</span>, <span class="st">&quot;el&quot;</span>, <span class="st">&quot;perro&quot;</span>, <span class="st">&quot;gato&quot;</span>, <span class="st">&quot;león&quot;</span>, <span class="st">&quot;corre&quot;</span>, <span class="st">&quot;caza&quot;</span>, <span class="st">&quot;_ss_&quot;</span>)</span>
<span id="cb846-5"><a href="representación-de-palabras-y-word2vec.html#cb846-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(C) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;d_1&quot;</span>, <span class="st">&quot;d_2&quot;</span>)</span>
<span id="cb846-6"><a href="representación-de-palabras-y-word2vec.html#cb846-6" aria-hidden="true" tabindex="-1"></a>C</span></code></pre></div>
<pre><code>##       _s_    el perro gato  león corre caza  _ss_
## d_1  0.13  0.05  0.05 0.04 -0.17  0.04 0.03 -0.02
## d_2 -0.19 -0.19 -0.11 0.01  0.04 -0.01 0.02  0.02</code></pre>
<p>En la siguiente capa consideremos que usaremos, arbitrariamente, <span class="math inline">\(h=3\)</span> unidades. Como estamos considerando bigramas, necesitamos una entrada de tamaño 4 (representación de un bigrama, que son dos vectores de la matriz <span class="math inline">\(C\)</span>, para predecir la siguiente palabra).</p>
<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb848-1"><a href="representación-de-palabras-y-word2vec.html#cb848-1" aria-hidden="true" tabindex="-1"></a>H <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">12</span>, <span class="dv">0</span>, <span class="fl">0.1</span>), <span class="dv">3</span>, <span class="dv">4</span>), <span class="dv">2</span>)</span>
<span id="cb848-2"><a href="representación-de-palabras-y-word2vec.html#cb848-2" aria-hidden="true" tabindex="-1"></a>H</span></code></pre></div>
<pre><code>##       [,1]  [,2]  [,3]  [,4]
## [1,] -0.04  0.12 -0.09  0.18
## [2,]  0.09  0.10  0.06  0.08
## [3,]  0.10 -0.08 -0.07 -0.13</code></pre>
<p>Y la última capa es la del vocabulario. Son entonces 8 unidades,
con 3 entradas cada una. La matriz de pesos es:</p>
<div class="sourceCode" id="cb850"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb850-1"><a href="representación-de-palabras-y-word2vec.html#cb850-1" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">24</span>, <span class="dv">0</span>, <span class="fl">0.1</span>), <span class="dv">8</span>, <span class="dv">3</span>), <span class="dv">2</span>)</span>
<span id="cb850-2"><a href="representación-de-palabras-y-word2vec.html#cb850-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(U) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;_s_&quot;</span>, <span class="st">&quot;el&quot;</span>, <span class="st">&quot;perro&quot;</span>, <span class="st">&quot;gato&quot;</span>, <span class="st">&quot;león&quot;</span>, <span class="st">&quot;corre&quot;</span>, <span class="st">&quot;caza&quot;</span>, <span class="st">&quot;_ss_&quot;</span>)</span>
<span id="cb850-3"><a href="representación-de-palabras-y-word2vec.html#cb850-3" aria-hidden="true" tabindex="-1"></a>U</span></code></pre></div>
<pre><code>##        [,1]  [,2]  [,3]
## _s_    0.05 -0.15 -0.30
## el     0.01  0.16  0.15
## perro -0.14  0.10  0.05
## gato   0.04  0.09  0.12
## león   0.06 -0.03  0.02
## corre -0.01  0.00 -0.02
## caza   0.10  0.00  0.06
## _ss_   0.07 -0.10  0.01</code></pre>
<p>Ahora consideremos cómo se calcula el objetivo con los
datos de entrenamiento. El primer trigrama es (_s_, el). La primera
capa entonces devuelve los dos vectores correspondientes a cada
palabra (concatenado):</p>
<div class="sourceCode" id="cb852"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb852-1"><a href="representación-de-palabras-y-word2vec.html#cb852-1" aria-hidden="true" tabindex="-1"></a>capa_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(C[, <span class="st">&quot;_s_&quot;</span>], C[, <span class="st">&quot;el&quot;</span>])</span>
<span id="cb852-2"><a href="representación-de-palabras-y-word2vec.html#cb852-2" aria-hidden="true" tabindex="-1"></a>capa_1</span></code></pre></div>
<pre><code>##   d_1   d_2   d_1   d_2 
##  0.13 -0.19  0.05 -0.19</code></pre>
<p>La siguiente capa es:</p>
<div class="sourceCode" id="cb854"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb854-1"><a href="representación-de-palabras-y-word2vec.html#cb854-1" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="cf">function</span>(z){ <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>z))}</span>
<span id="cb854-2"><a href="representación-de-palabras-y-word2vec.html#cb854-2" aria-hidden="true" tabindex="-1"></a>capa_2 <span class="ot">&lt;-</span> <span class="fu">sigma</span>(H <span class="sc">%*%</span> capa_1)</span>
<span id="cb854-3"><a href="representación-de-palabras-y-word2vec.html#cb854-3" aria-hidden="true" tabindex="-1"></a>capa_2</span></code></pre></div>
<pre><code>##           [,1]
## [1,] 0.4833312
## [2,] 0.4951252
## [3,] 0.5123475</code></pre>
<p>Y la capa final da</p>
<div class="sourceCode" id="cb856"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb856-1"><a href="representación-de-palabras-y-word2vec.html#cb856-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> U <span class="sc">%*%</span> capa_2</span>
<span id="cb856-2"><a href="representación-de-palabras-y-word2vec.html#cb856-2" aria-hidden="true" tabindex="-1"></a>y</span></code></pre></div>
<pre><code>##               [,1]
## _s_   -0.203806461
## el     0.160905460
## perro  0.007463525
## gato   0.125376210
## león   0.024393066
## corre -0.015080262
## caza   0.079073967
## _ss_  -0.010555858</code></pre>
<p>Y aplicamos softmax para encontrar las probabilidades</p>
<div class="sourceCode" id="cb858"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb858-1"><a href="representación-de-palabras-y-word2vec.html#cb858-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">exp</span>(y)<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">exp</span>(y)) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb858-2"><a href="representación-de-palabras-y-word2vec.html#cb858-2" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>##             [,1]
## _s_   0.09931122
## el    0.14301799
## perro 0.12267376
## gato  0.13802588
## león  0.12476825
## corre 0.11993917
## caza  0.13178067
## _ss_  0.12048306</code></pre>
<p>Y la probabilidad es entonces</p>
<div class="sourceCode" id="cb860"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb860-1"><a href="representación-de-palabras-y-word2vec.html#cb860-1" aria-hidden="true" tabindex="-1"></a>p_1 <span class="ot">&lt;-</span> p[<span class="st">&quot;perro&quot;</span>, <span class="dv">1</span>]</span>
<span id="cb860-2"><a href="representación-de-palabras-y-word2vec.html#cb860-2" aria-hidden="true" tabindex="-1"></a>p_1</span></code></pre></div>
<pre><code>##     perro 
## 0.1226738</code></pre>
<p>Cuya log probabilidad es</p>
<div class="sourceCode" id="cb862"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb862-1"><a href="representación-de-palabras-y-word2vec.html#cb862-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(p_1)</span></code></pre></div>
<pre><code>##     perro 
## -2.098227</code></pre>
<p>Ahora seguimos con el siguiente trigrama, que
es “(perro, corre).” Necesitamos calcular la probabilidad
de corre dado el contexto “el perro.” Repetimos nuestro cálculo:</p>
<div class="sourceCode" id="cb864"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb864-1"><a href="representación-de-palabras-y-word2vec.html#cb864-1" aria-hidden="true" tabindex="-1"></a>capa_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(C[, <span class="st">&quot;el&quot;</span>], C[, <span class="st">&quot;perro&quot;</span>])</span>
<span id="cb864-2"><a href="representación-de-palabras-y-word2vec.html#cb864-2" aria-hidden="true" tabindex="-1"></a>capa_1</span></code></pre></div>
<pre><code>##   d_1   d_2   d_1   d_2 
##  0.05 -0.19  0.05 -0.11</code></pre>
<div class="sourceCode" id="cb866"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb866-1"><a href="representación-de-palabras-y-word2vec.html#cb866-1" aria-hidden="true" tabindex="-1"></a>capa_2 <span class="ot">&lt;-</span> <span class="fu">sigma</span>(H <span class="sc">%*%</span> capa_1)</span>
<span id="cb866-2"><a href="representación-de-palabras-y-word2vec.html#cb866-2" aria-hidden="true" tabindex="-1"></a>capa_2</span></code></pre></div>
<pre><code>##           [,1]
## [1,] 0.4877275
## [2,] 0.4949252
## [3,] 0.5077494</code></pre>
<div class="sourceCode" id="cb868"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb868-1"><a href="representación-de-palabras-y-word2vec.html#cb868-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> U <span class="sc">%*%</span> capa_2</span>
<span id="cb868-2"><a href="representación-de-palabras-y-word2vec.html#cb868-2" aria-hidden="true" tabindex="-1"></a>y</span></code></pre></div>
<pre><code>##               [,1]
## _s_   -0.202177217
## el     0.160227709
## perro  0.006598141
## gato   0.124982290
## león   0.024570880
## corre -0.015032262
## caza   0.079237709
## _ss_  -0.010274101</code></pre>
<div class="sourceCode" id="cb870"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb870-1"><a href="representación-de-palabras-y-word2vec.html#cb870-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">exp</span>(y)<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">exp</span>(y)) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb870-2"><a href="representación-de-palabras-y-word2vec.html#cb870-2" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>##             [,1]
## _s_   0.09947434
## el    0.14292280
## perro 0.12256912
## gato  0.13797317
## león  0.12479193
## corre 0.11994636
## caza  0.13180383
## _ss_  0.12051845</code></pre>
<p>Y la probabilidad es entonces</p>
<div class="sourceCode" id="cb872"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb872-1"><a href="representación-de-palabras-y-word2vec.html#cb872-1" aria-hidden="true" tabindex="-1"></a>p_2 <span class="ot">&lt;-</span> p[<span class="st">&quot;corre&quot;</span>, <span class="dv">1</span>]</span>
<span id="cb872-2"><a href="representación-de-palabras-y-word2vec.html#cb872-2" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(p_2)</span></code></pre></div>
<pre><code>##     corre 
## -2.120711</code></pre>
<p>Sumando, la log probabilidad es:</p>
<div class="sourceCode" id="cb874"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb874-1"><a href="representación-de-palabras-y-word2vec.html#cb874-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(p_1) <span class="sc">+</span> <span class="fu">log</span>(p_2)</span></code></pre></div>
<pre><code>##     perro 
## -4.218937</code></pre>
<p>y continuamos con los siguientes trigramas del texto de entrenamiento.
Creamos una función</p>
<div class="sourceCode" id="cb876"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb876-1"><a href="representación-de-palabras-y-word2vec.html#cb876-1" aria-hidden="true" tabindex="-1"></a>feed_fow_p <span class="ot">&lt;-</span> <span class="cf">function</span>(trigrama, C, H, U){</span>
<span id="cb876-2"><a href="representación-de-palabras-y-word2vec.html#cb876-2" aria-hidden="true" tabindex="-1"></a>  trigrama <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(trigrama, <span class="st">&quot; &quot;</span>, <span class="at">fixed =</span> <span class="cn">TRUE</span>)[[<span class="dv">1</span>]]</span>
<span id="cb876-3"><a href="representación-de-palabras-y-word2vec.html#cb876-3" aria-hidden="true" tabindex="-1"></a>  capa_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(C[, trigrama[<span class="dv">1</span>]], C[, trigrama[<span class="dv">2</span>]])</span>
<span id="cb876-4"><a href="representación-de-palabras-y-word2vec.html#cb876-4" aria-hidden="true" tabindex="-1"></a>  capa_2 <span class="ot">&lt;-</span> <span class="fu">sigma</span>(H <span class="sc">%*%</span> capa_1)</span>
<span id="cb876-5"><a href="representación-de-palabras-y-word2vec.html#cb876-5" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> U <span class="sc">%*%</span> capa_2</span>
<span id="cb876-6"><a href="representación-de-palabras-y-word2vec.html#cb876-6" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">exp</span>(y)<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">exp</span>(y)) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb876-7"><a href="representación-de-palabras-y-word2vec.html#cb876-7" aria-hidden="true" tabindex="-1"></a>  p</span>
<span id="cb876-8"><a href="representación-de-palabras-y-word2vec.html#cb876-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb876-9"><a href="representación-de-palabras-y-word2vec.html#cb876-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb876-10"><a href="representación-de-palabras-y-word2vec.html#cb876-10" aria-hidden="true" tabindex="-1"></a>feed_fow_dev <span class="ot">&lt;-</span> <span class="cf">function</span>(trigrama, C, H, U) {</span>
<span id="cb876-11"><a href="representación-de-palabras-y-word2vec.html#cb876-11" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">feed_fow_p</span>(trigrama, C, H, U)</span>
<span id="cb876-12"><a href="representación-de-palabras-y-word2vec.html#cb876-12" aria-hidden="true" tabindex="-1"></a>  trigrama_s <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(trigrama, <span class="st">&quot; &quot;</span>, <span class="at">fixed =</span> <span class="cn">TRUE</span>)[[<span class="dv">1</span>]]</span>
<span id="cb876-13"><a href="representación-de-palabras-y-word2vec.html#cb876-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(p)[trigrama_s[<span class="dv">3</span>], <span class="dv">1</span>]</span>
<span id="cb876-14"><a href="representación-de-palabras-y-word2vec.html#cb876-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Y ahora aplicamos a todos los textos:</p>
<div class="sourceCode" id="cb877"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb877-1"><a href="representación-de-palabras-y-word2vec.html#cb877-1" aria-hidden="true" tabindex="-1"></a>texto_entrena <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;_s_ el perro corre _ss_&quot;</span>, <span class="st">&quot; _s_ el gato corre _ss_&quot;</span>, <span class="st">&quot; _s_ el león corre _ss_&quot;</span>,</span>
<span id="cb877-2"><a href="representación-de-palabras-y-word2vec.html#cb877-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;_s_ el león caza _ss_&quot;</span>,  <span class="st">&quot;_s_ el gato caza _ss_&quot;</span>)</span>
<span id="cb877-3"><a href="representación-de-palabras-y-word2vec.html#cb877-3" aria-hidden="true" tabindex="-1"></a>entrena_trigramas <span class="ot">&lt;-</span> <span class="fu">map</span>(texto_entrena, </span>
<span id="cb877-4"><a href="representación-de-palabras-y-word2vec.html#cb877-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>tokenizers<span class="sc">::</span><span class="fu">tokenize_ngrams</span>(.x, <span class="at">n =</span> <span class="dv">3</span>)[[<span class="dv">1</span>]]) <span class="sc">|&gt;</span> </span>
<span id="cb877-5"><a href="representación-de-palabras-y-word2vec.html#cb877-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flatten</span>() <span class="sc">|&gt;</span> <span class="fu">unlist</span>()</span>
<span id="cb877-6"><a href="representación-de-palabras-y-word2vec.html#cb877-6" aria-hidden="true" tabindex="-1"></a>entrena_trigramas</span></code></pre></div>
<pre><code>##  [1] &quot;_s_ el perro&quot;     &quot;el perro corre&quot;   &quot;perro corre _ss_&quot; &quot;_s_ el gato&quot;     
##  [5] &quot;el gato corre&quot;    &quot;gato corre _ss_&quot;  &quot;_s_ el león&quot;      &quot;el león corre&quot;   
##  [9] &quot;león corre _ss_&quot;  &quot;_s_ el león&quot;      &quot;el león caza&quot;     &quot;león caza _ss_&quot;  
## [13] &quot;_s_ el gato&quot;      &quot;el gato caza&quot;     &quot;gato caza _ss_&quot;</code></pre>
<div class="sourceCode" id="cb879"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb879-1"><a href="representación-de-palabras-y-word2vec.html#cb879-1" aria-hidden="true" tabindex="-1"></a>log_p <span class="ot">&lt;-</span> <span class="fu">sapply</span>(entrena_trigramas, <span class="cf">function</span>(x) <span class="fu">feed_fow_dev</span>(x, C, H, U))</span>
<span id="cb879-2"><a href="representación-de-palabras-y-word2vec.html#cb879-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(log_p)</span></code></pre></div>
<pre><code>## [1] -31.21475</code></pre>
<p>Ahora piensa como harías más grande esta verosimilitud. Observa
que “perro,” “gato” y “león”” están comunmente seguidos de “corre.”
Esto implica que nos convendría que hubiera cierta similitud
entre los vectores de estas tres palabras, por ejemplo:</p>
<div class="sourceCode" id="cb881"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb881-1"><a href="representación-de-palabras-y-word2vec.html#cb881-1" aria-hidden="true" tabindex="-1"></a>C_1 <span class="ot">&lt;-</span> C</span>
<span id="cb881-2"><a href="representación-de-palabras-y-word2vec.html#cb881-2" aria-hidden="true" tabindex="-1"></a>indices <span class="ot">&lt;-</span> <span class="fu">colnames</span>(C) <span class="sc">%in%</span>  <span class="fu">c</span>(<span class="st">&quot;perro&quot;</span>, <span class="st">&quot;gato&quot;</span>, <span class="st">&quot;león&quot;</span>)</span>
<span id="cb881-3"><a href="representación-de-palabras-y-word2vec.html#cb881-3" aria-hidden="true" tabindex="-1"></a>C_1[<span class="dv">1</span>, indices] <span class="ot">&lt;-</span> <span class="fl">3.0</span></span>
<span id="cb881-4"><a href="representación-de-palabras-y-word2vec.html#cb881-4" aria-hidden="true" tabindex="-1"></a>C_1[<span class="dv">1</span>, <span class="sc">!</span>indices] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">1.0</span></span>
<span id="cb881-5"><a href="representación-de-palabras-y-word2vec.html#cb881-5" aria-hidden="true" tabindex="-1"></a>C_1</span></code></pre></div>
<pre><code>##       _s_    el perro gato león corre  caza  _ss_
## d_1 -1.00 -1.00  3.00 3.00 3.00 -1.00 -1.00 -1.00
## d_2 -0.19 -0.19 -0.11 0.01 0.04 -0.01  0.02  0.02</code></pre>
<p>La siguiente capa queremos que extraiga el concepto “animal” en la palabra anterior, o algo
similar, así que podríamos poner en la unidad 1:</p>
<div class="sourceCode" id="cb883"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb883-1"><a href="representación-de-palabras-y-word2vec.html#cb883-1" aria-hidden="true" tabindex="-1"></a>H_1 <span class="ot">&lt;-</span> H</span>
<span id="cb883-2"><a href="representación-de-palabras-y-word2vec.html#cb883-2" aria-hidden="true" tabindex="-1"></a>H_1[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">0</span>)</span>
<span id="cb883-3"><a href="representación-de-palabras-y-word2vec.html#cb883-3" aria-hidden="true" tabindex="-1"></a>H_1</span></code></pre></div>
<pre><code>##      [,1]  [,2]  [,3]  [,4]
## [1,] 0.00  0.00  5.00  0.00
## [2,] 0.09  0.10  0.06  0.08
## [3,] 0.10 -0.08 -0.07 -0.13</code></pre>
<p>Nótese que la unidad 1 de la segunda capa se activa
cuando la primera componente de la palabra anterior es alta.
En la última capa, podríamos entonces poner</p>
<div class="sourceCode" id="cb885"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb885-1"><a href="representación-de-palabras-y-word2vec.html#cb885-1" aria-hidden="true" tabindex="-1"></a>U_1 <span class="ot">&lt;-</span> U</span>
<span id="cb885-2"><a href="representación-de-palabras-y-word2vec.html#cb885-2" aria-hidden="true" tabindex="-1"></a>U_1[<span class="st">&quot;corre&quot;</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">4.0</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb885-3"><a href="representación-de-palabras-y-word2vec.html#cb885-3" aria-hidden="true" tabindex="-1"></a>U_1[<span class="st">&quot;caza&quot;</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">4.2</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb885-4"><a href="representación-de-palabras-y-word2vec.html#cb885-4" aria-hidden="true" tabindex="-1"></a>U_1</span></code></pre></div>
<pre><code>##        [,1]  [,2]  [,3]
## _s_    0.05 -0.15 -0.30
## el     0.01  0.16  0.15
## perro -0.14  0.10  0.05
## gato   0.04  0.09  0.12
## león   0.06 -0.03  0.02
## corre  4.00 -2.00 -2.00
## caza   4.20 -2.00 -2.00
## _ss_   0.07 -0.10  0.01</code></pre>
<p>que captura cuando la primera unidad se activa. Ahora el cálculo
completo es:</p>
<div class="sourceCode" id="cb887"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb887-1"><a href="representación-de-palabras-y-word2vec.html#cb887-1" aria-hidden="true" tabindex="-1"></a>log_p <span class="ot">&lt;-</span> <span class="fu">sapply</span>(entrena_trigramas, <span class="cf">function</span>(x) <span class="fu">feed_fow_dev</span>(x, C_1, H_1, U_1))</span>
<span id="cb887-2"><a href="representación-de-palabras-y-word2vec.html#cb887-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(log_p)</span></code></pre></div>
<pre><code>## [1] -23.53883</code></pre>
<p>Y logramos aumentar la verosimilitud considerablemente. Compara las probabilidades:</p>
<div class="sourceCode" id="cb889"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb889-1"><a href="representación-de-palabras-y-word2vec.html#cb889-1" aria-hidden="true" tabindex="-1"></a><span class="fu">feed_fow_p</span>(<span class="st">&quot;el perro&quot;</span>, C, H, U)</span></code></pre></div>
<pre><code>##             [,1]
## _s_   0.09947434
## el    0.14292280
## perro 0.12256912
## gato  0.13797317
## león  0.12479193
## corre 0.11994636
## caza  0.13180383
## _ss_  0.12051845</code></pre>
<div class="sourceCode" id="cb891"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb891-1"><a href="representación-de-palabras-y-word2vec.html#cb891-1" aria-hidden="true" tabindex="-1"></a><span class="fu">feed_fow_p</span>(<span class="st">&quot;el perro&quot;</span>, C_1, H_1, U_1)</span></code></pre></div>
<pre><code>##             [,1]
## _s_   0.03493901
## el    0.04780222
## perro 0.03821035
## gato  0.04690264
## león  0.04308502
## corre 0.33639351
## caza  0.41087194
## _ss_  0.04179531</code></pre>
<div class="sourceCode" id="cb893"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb893-1"><a href="representación-de-palabras-y-word2vec.html#cb893-1" aria-hidden="true" tabindex="-1"></a><span class="fu">feed_fow_p</span>(<span class="st">&quot;el gato&quot;</span>, C, H, U)</span></code></pre></div>
<pre><code>##             [,1]
## _s_   0.09957218
## el    0.14289131
## perro 0.12246787
## gato  0.13795972
## león  0.12480659
## corre 0.11993921
## caza  0.13183822
## _ss_  0.12052489</code></pre>
<div class="sourceCode" id="cb895"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb895-1"><a href="representación-de-palabras-y-word2vec.html#cb895-1" aria-hidden="true" tabindex="-1"></a><span class="fu">feed_fow_p</span>(<span class="st">&quot;el gato&quot;</span>, C_1, H_1, U_1)</span></code></pre></div>
<pre><code>##             [,1]
## _s_   0.03489252
## el    0.04769205
## perro 0.03813136
## gato  0.04679205
## león  0.04298749
## corre 0.33663831
## caza  0.41117094
## _ss_  0.04169529</code></pre>
<p><strong>Observación</strong>: a partir de este principio, es posible construir arquitecturas más
refinadas que tomen en cuenta, por ejemplo, relaciones más lejanas entre
partes de oraciones (no solo el contexto del n-grama), ver por ejemplo <a href="https://www.deeplearningbook.org/contents/rnn.html">el capítulo 10 del libro
de Deep Learning de Goodfellow, Bengio y Courville</a>.</p>
<p>Abajo exploramos una parte fundamental de estos modelos: representaciones de palabras, y modelos
relativamente simples para obtener estas representaciones.</p>
</div>
</div>
<div id="representación-de-palabras" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> Representación de palabras</h2>
<p>Un aspecto interesante de el modelo de arriba es que
nos da una representación vectorial de las palabras, en la forma
de los parámetros ajustados de la matriz <span class="math inline">\(C\)</span>. Esta se puede entender
como una descripción numérica de cómo funciona una palabra en el contexto de su n-grama.</p>
<p>Por ejemplo, deberíamos encontrar que palabras como “perro” y “gato” tienen representaciones similares. La razón es que cuando aparecen,
las probabilidades sobre las palabras siguientes deberían ser similares, pues estas son dos palabras que se pueden usar en muchos contextos
compartidos.</p>
<p>También podríamos encontrar que palabras como perro, gato, águila, león, etc. tienen partes o entradas similares en sus vectores de representación, que es la parte que hace que funcionen como “animal mamífero” dentro de frases.</p>
<p>Veremos que hay más razones por las que es interesante esta representación.</p>
</div>
<div id="modelos-de-word2vec" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> Modelos de word2vec</h2>
<p>Si lo que principalmente nos interesa es obtener la representación
vectorial de palabras, más recientemente se descubrió que es posible
simplificar considerablemente el modelo de arriba para poder entrenarlo mucho más rápido, y obtener una representación que en muchas tareas se desempeña bien (<span class="citation">(<a href="#ref-word2vec" role="doc-biblioref">Mikolov et al. 2013</a>)</span>).</p>
<p>Hay dos ideas básicas que se pueden usar para reducir la complejidad del entrenamiento (ver más
en <span class="citation">(<a href="#ref-goodfellow" role="doc-biblioref">Goodfellow, Bengio, and Courville 2016</a>)</span> y <span class="citation">(<a href="#ref-word2vec" role="doc-biblioref">Mikolov et al. 2013</a>)</span>:</p>
<ul>
<li>Eliminar la segunda capa oculta: modelo de <em>bag-of-words</em> continuo y modelo de <em>skip-gram</em>.</li>
<li>Cambiar la función objetivo (minimizar devianza/maximizar verosimilitud) por una más simple, mediante un truco que se llama <em>negative sampling</em>.</li>
</ul>
<p>Como ya no es de interés central predecir la siguiente palabra a partir
de las anteriores, en estos modelos <strong>intentamos predecir la palabra
central a partir de las que están alrededor</strong>.</p>
<div id="arquitectura-continuous-bag-of-words" class="section level3 unnumbered">
<h3>Arquitectura continuous bag-of-words</h3>
<p>La entrada es igual que en el modelo completo. En primer lugar,
simplificamos la segunda capa oculta pondiendo en <span class="math inline">\(z\)</span> el promedio de
los vectores <span class="math inline">\(C(w_{n-2}), C(w_{n-1})\)</span>. La última capa la dejamos igual por el momento:</p>
<div class="figure">
<img src="images/cbow_fig.png" alt="" />
<p class="caption">Imagen</p>
</div>
<p>El modelo se llama bag-of-words porque todas las entradas de la primera capa oculta contribuyen de la misma manera en la salida, independientemente del orden. Aunque esto no suena como buena idea para construir un modelo de lenguaje, veremos que resulta en una representación adecuada para algunos problemas.</p>
<ol style="list-style-type: decimal">
<li>En la primera capa oculta, tenemos un mapeo de las entradas <span class="math inline">\(w_1,\ldots, w_{n-1}\)</span> a <span class="math inline">\(x=C(w_1),\ldots, C(w_{n-1})\)</span>, donde <span class="math inline">\(C\)</span> es una función que mapea palabras a vectores de dimensión <span class="math inline">\(d\)</span>. <span class="math inline">\(C\)</span> también se puede pensar como una matriz de dimensión <span class="math inline">\(|V|\)</span> por <span class="math inline">\(d\)</span>. En la capa de entrada,</li>
</ol>
<p><span class="math display">\[w_{n-2},w_{n-1} \to x = (C(w_{n-2}), C(w_{n-1})).\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li><p>En la siguiente “capa” oculta simplemente sumamos las entradas de <span class="math inline">\(x\)</span>. Aquí nótese que realmente no hay parámetros.</p></li>
<li><p>Finalmente, la capa de salida debe ser un vector de probabilidades
sobre todo el vocabulario <span class="math inline">\(|V|\)</span>. En esta capa tenemos pesos <span class="math inline">\(U\)</span> y hacemos
<span class="math display">\[y = b + U\sigma (z),\]</span>
y finalmente usamos softmax para tener probabilidades que suman uno:
<span class="math display">\[p_i = \frac{\exp (y_i) }{\sum_j exp(y_j)}.\]</span></p></li>
</ol>
<p>En el ajuste maximizamos la verosimilitud sobre el corpus. Por ejemplo, para una frase, su log verosimilitud es:</p>
<p><span class="math display">\[\sum_t \log \hat{P}(w_{t,n}|w_{t,n+1} \cdots w_{t-n-1}) \]</span></p>
</div>
<div id="arquitectura-skip-grams" class="section level3 unnumbered">
<h3>Arquitectura skip-grams</h3>
<p>Otro modelo simplificado, con más complejidad computacional pero
mejores resultados (ver <span class="citation">(<a href="#ref-word2vec" role="doc-biblioref">Mikolov et al. 2013</a>)</span>) que
el bag-of-words, es el modelo de skip-grams. En este caso, dada
cada palabra que encontramos, intentamos predecir un número
fijo de las palabras anteriores y palabras posteriores
(el contexto es una vecindad de la palabra).</p>
<div class="figure">
<img src="images/skipgram.png" alt="" />
<p class="caption">Imagen</p>
</div>
<p>La función objetivo se defina ahora (simplificando) como suma sobre <span class="math inline">\(t\)</span>:</p>
<p><span class="math display">\[-\sum_t \sum_{ -2\leq j \leq 2, j\neq 0} \log P(w_{t-j} | w_t)\]</span>
(no tomamos en cuenta dónde aparece exactamente <span class="math inline">\(w_{t-j}\)</span> en relación a <span class="math inline">\(w_t\)</span>, simplemente consideramos que está en su contexto),
donde</p>
<p><span class="math display">\[\log P(w_{t-j}|w_t) =  u_{t-j}^tC(w_t) - \log\sum_k \exp{u_{k}^tC(w_t)}\]</span></p>
<p>Todavía se propone una simplificación adicional que resulta ser efectiva:</p>
</div>
<div id="muestreo-negativo" class="section level3 unnumbered">
<h3>Muestreo negativo</h3>
<p>La siguiente simplificación consiste en cambiar la función objetivo. En word2vec puede usarse “muestreo negativo.”</p>
<p>Para empezar, la función objetivo original (para contexto de una sola palabra) es</p>
<p><span class="math display">\[E = -\log \hat{P}(w_{a}|w_{n}) = -y_{w_a} + \log\sum_j \exp(y_j),\]</span></p>
<p>donde las <span class="math inline">\(y_i\)</span> son las salidas de la penúltima capa. La dificultad está en el segundo término, que es sobre todo el vocabulario en incluye todos los parámetros del modelo (hay que calcular las parciales de <span class="math inline">\(y_j\)</span>’s
sobre cada una de las palabras del vocabulario).</p>
<p>La idea del muestreo negativo es que si <span class="math inline">\(w_a\)</span>
está en el contexto de <span class="math inline">\(w_{n}\)</span>, tomamos una muestra de <span class="math inline">\(k\)</span> palabras
<span class="math inline">\(v_1,\ldots v_k\)</span> al azar
(2-50, dependiendo del tamaño de la colección), y creamos <span class="math inline">\(k\)</span>
“contextos falsos” <span class="math inline">\(v_j w_{n}\)</span>, <span class="math inline">\(j=1\ldots,k\)</span>. Minimizamos
en lugar de la observación de arriba</p>
<p><span class="math display">\[E = -\log\sigma(y_{w_a}) + \sum_{j=1}^k \log\sigma(y_j),\]</span>
en donde queremos maximizar la probabilidad de que ocurra
<span class="math inline">\(w_a\)</span> vs. la probabilidad de que ocurra alguna de las <span class="math inline">\(v_j\)</span>.
Es decir, solo buscamos optimizar parámetros para separar lo mejor
que podamos la observación de <span class="math inline">\(k\)</span> observaciones falsas, lo cual implica que tenemos que mover un número relativamente chico de
parámetros (en lugar de todos los parámetros de todas las palabras del vocabulario).</p>
<p>Las palabras “falsas” se escogen según una probabilidad ajustada
de unigramas (se observó empíricamente mejor desempeño cuando escogemos cada palabra con probabilidad proporcional a <span class="math inline">\(P(w)^{3/4}\)</span>, en lugar de <span class="math inline">\(P(w)\)</span>, ver <span class="citation">(<a href="#ref-word2vec" role="doc-biblioref">Mikolov et al. 2013</a>)</span>).</p>
</div>
<div id="ejemplo-33" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<div class="sourceCode" id="cb897"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb897-1"><a href="representación-de-palabras-y-word2vec.html#cb897-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(wordVectors)){</span>
<span id="cb897-2"><a href="representación-de-palabras-y-word2vec.html#cb897-2" aria-hidden="true" tabindex="-1"></a>  devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;bmschmidt/wordVectors&quot;</span>)</span>
<span id="cb897-3"><a href="representación-de-palabras-y-word2vec.html#cb897-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## pillar     (1.6.4  -&gt; 1.7.0) [CRAN]
## magrittr   (2.0.1  -&gt; 2.0.3) [CRAN]
## fansi      (0.5.0  -&gt; 1.0.3) [CRAN]
## withr      (2.4.3  -&gt; 2.5.0) [CRAN]
## tidyselect (1.1.1  -&gt; 1.1.2) [CRAN]
## vctrs      (0.3.8  -&gt; 0.4.1) [CRAN]
## tzdb       (0.2.0  -&gt; 0.3.0) [CRAN]
## tibble     (3.1.6  -&gt; 3.1.7) [CRAN]
## rlang      (0.4.12 -&gt; 1.0.2) [CRAN]
## glue       (1.6.0  -&gt; 1.6.2) [CRAN]
## cli        (3.1.0  -&gt; 3.3.0) [CRAN]
## crayon     (1.4.2  -&gt; 1.5.1) [CRAN]
## clipr      (0.7.1  -&gt; 0.8.0) [CRAN]
## readr      (2.1.1  -&gt; 2.1.2) [CRAN]
## * checking for file ‘/tmp/RtmpH4Bct7/remotes481028505762/bmschmidt-wordVectors-7f1914c/DESCRIPTION’ ... OK
## * preparing ‘wordVectors’:
## * checking DESCRIPTION meta-information ... OK
## * cleaning src
## * checking for LF line-endings in source and make files and shell scripts
## * checking for empty or unneeded directories
## * building ‘wordVectors_2.0.tar.gz’</code></pre>
<div class="sourceCode" id="cb899"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb899-1"><a href="representación-de-palabras-y-word2vec.html#cb899-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wordVectors)</span></code></pre></div>
<div class="sourceCode" id="cb900"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb900-1"><a href="representación-de-palabras-y-word2vec.html#cb900-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb900-2"><a href="representación-de-palabras-y-word2vec.html#cb900-2" aria-hidden="true" tabindex="-1"></a>ruta <span class="ot">&lt;-</span> <span class="st">&quot;../datos/noticias/ES_Newspapers.txt&quot;</span></span>
<span id="cb900-3"><a href="representación-de-palabras-y-word2vec.html#cb900-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(ruta)){</span>
<span id="cb900-4"><a href="representación-de-palabras-y-word2vec.html#cb900-4" aria-hidden="true" tabindex="-1"></a>    periodico <span class="ot">&lt;-</span> </span>
<span id="cb900-5"><a href="representación-de-palabras-y-word2vec.html#cb900-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">read_lines</span>(<span class="at">file=</span> <span class="st">&quot;https://es-noticias.s3.amazonaws.com/Es_Newspapers.txt&quot;</span>,</span>
<span id="cb900-6"><a href="representación-de-palabras-y-word2vec.html#cb900-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">progress =</span> <span class="cn">FALSE</span>)</span>
<span id="cb900-7"><a href="representación-de-palabras-y-word2vec.html#cb900-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write_lines</span>(periodico, ruta)</span>
<span id="cb900-8"><a href="representación-de-palabras-y-word2vec.html#cb900-8" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb900-9"><a href="representación-de-palabras-y-word2vec.html#cb900-9" aria-hidden="true" tabindex="-1"></a>    periodico <span class="ot">&lt;-</span> <span class="fu">read_lines</span>(<span class="at">file=</span> ruta,</span>
<span id="cb900-10"><a href="representación-de-palabras-y-word2vec.html#cb900-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">progress =</span> <span class="cn">FALSE</span>)</span>
<span id="cb900-11"><a href="representación-de-palabras-y-word2vec.html#cb900-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb900-12"><a href="representación-de-palabras-y-word2vec.html#cb900-12" aria-hidden="true" tabindex="-1"></a>normalizar <span class="ot">&lt;-</span> <span class="cf">function</span>(texto, <span class="at">vocab =</span> <span class="cn">NULL</span>){</span>
<span id="cb900-13"><a href="representación-de-palabras-y-word2vec.html#cb900-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># minúsculas</span></span>
<span id="cb900-14"><a href="representación-de-palabras-y-word2vec.html#cb900-14" aria-hidden="true" tabindex="-1"></a>  texto <span class="ot">&lt;-</span> <span class="fu">tolower</span>(texto)</span>
<span id="cb900-15"><a href="representación-de-palabras-y-word2vec.html#cb900-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># varios ajustes</span></span>
<span id="cb900-16"><a href="representación-de-palabras-y-word2vec.html#cb900-16" aria-hidden="true" tabindex="-1"></a>  texto <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">s+&quot;</span>, <span class="st">&quot; &quot;</span>, texto)</span>
<span id="cb900-17"><a href="representación-de-palabras-y-word2vec.html#cb900-17" aria-hidden="true" tabindex="-1"></a>  texto <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">.[^0-9]&quot;</span>, <span class="st">&quot; _punto_ &quot;</span>, texto)</span>
<span id="cb900-18"><a href="representación-de-palabras-y-word2vec.html#cb900-18" aria-hidden="true" tabindex="-1"></a>  texto <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot; _s_ $&quot;</span>, <span class="st">&quot;&quot;</span>, texto)</span>
<span id="cb900-19"><a href="representación-de-palabras-y-word2vec.html#cb900-19" aria-hidden="true" tabindex="-1"></a>  texto <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>, <span class="st">&quot; _punto_ &quot;</span>, texto)</span>
<span id="cb900-20"><a href="representación-de-palabras-y-word2vec.html#cb900-20" aria-hidden="true" tabindex="-1"></a>  texto <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;[«»¡!¿?-]&quot;</span>, <span class="st">&quot;&quot;</span>, texto) </span>
<span id="cb900-21"><a href="representación-de-palabras-y-word2vec.html#cb900-21" aria-hidden="true" tabindex="-1"></a>  texto <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;;&quot;</span>, <span class="st">&quot; _punto_coma_ &quot;</span>, texto) </span>
<span id="cb900-22"><a href="representación-de-palabras-y-word2vec.html#cb900-22" aria-hidden="true" tabindex="-1"></a>  texto <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">:&quot;</span>, <span class="st">&quot; _dos_puntos_ &quot;</span>, texto) </span>
<span id="cb900-23"><a href="representación-de-palabras-y-word2vec.html#cb900-23" aria-hidden="true" tabindex="-1"></a>  texto <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">,[^0-9]&quot;</span>, <span class="st">&quot; _coma_ &quot;</span>, texto)</span>
<span id="cb900-24"><a href="representación-de-palabras-y-word2vec.html#cb900-24" aria-hidden="true" tabindex="-1"></a>  texto <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">s+&quot;</span>, <span class="st">&quot; &quot;</span>, texto)</span>
<span id="cb900-25"><a href="representación-de-palabras-y-word2vec.html#cb900-25" aria-hidden="true" tabindex="-1"></a>  texto</span>
<span id="cb900-26"><a href="representación-de-palabras-y-word2vec.html#cb900-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb900-27"><a href="representación-de-palabras-y-word2vec.html#cb900-27" aria-hidden="true" tabindex="-1"></a>periodico_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">txt =</span> periodico) <span class="sc">|&gt;</span></span>
<span id="cb900-28"><a href="representación-de-palabras-y-word2vec.html#cb900-28" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span></span>
<span id="cb900-29"><a href="representación-de-palabras-y-word2vec.html#cb900-29" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">txt =</span> <span class="fu">normalizar</span>(txt))</span></code></pre></div>
<p>Construimos un modelo con vectores de palabras de tamaño 100,
skip-grams de tamaño 4, y ajustamos con muestreo negativo
de tamaño 20:</p>
<div class="sourceCode" id="cb901"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb901-1"><a href="representación-de-palabras-y-word2vec.html#cb901-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">&#39;./salidas/noticias_w2v.txt&#39;</span>)){</span>
<span id="cb901-2"><a href="representación-de-palabras-y-word2vec.html#cb901-2" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">tempfile</span>()</span>
<span id="cb901-3"><a href="representación-de-palabras-y-word2vec.html#cb901-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># tokenización</span></span>
<span id="cb901-4"><a href="representación-de-palabras-y-word2vec.html#cb901-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_lines</span>(periodico_df<span class="sc">$</span>txt,  tmp)</span>
<span id="cb901-5"><a href="representación-de-palabras-y-word2vec.html#cb901-5" aria-hidden="true" tabindex="-1"></a>  prep <span class="ot">&lt;-</span> <span class="fu">prep_word2vec</span>(tmp, </span>
<span id="cb901-6"><a href="representación-de-palabras-y-word2vec.html#cb901-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">destination =</span> <span class="st">&#39;./salidas/noticias_w2v.txt&#39;</span>, <span class="at">bundle_ngrams =</span> <span class="dv">2</span>)</span>
<span id="cb901-7"><a href="representación-de-palabras-y-word2vec.html#cb901-7" aria-hidden="true" tabindex="-1"></a>  } </span></code></pre></div>
<pre><code>## Beginning tokenization to text file at ./salidas/noticias_w2v.txt</code></pre>
<pre><code>## Prepping /tmp/RtmpH4Bct7/file48103cb35a2</code></pre>
<pre><code>## Starting training using file ./salidas/noticias_w2v.txt
## Words processed: 100K     Vocab size: 73K  
Words processed: 200K     Vocab size: 124K  
Words processed: 300K     Vocab size: 168K  
Words processed: 400K     Vocab size: 209K  
Words processed: 500K     Vocab size: 247K  
Words processed: 600K     Vocab size: 281K  
Words processed: 700K     Vocab size: 314K  
Words processed: 800K     Vocab size: 346K  
Words processed: 900K     Vocab size: 376K  
Words processed: 1000K     Vocab size: 406K  
Words processed: 1100K     Vocab size: 434K  
Words processed: 1200K     Vocab size: 462K  
Words processed: 1300K     Vocab size: 489K  
Words processed: 1400K     Vocab size: 515K  
Words processed: 1500K     Vocab size: 540K  
Words processed: 1600K     Vocab size: 565K  
Words processed: 1700K     Vocab size: 590K  
Words processed: 1800K     Vocab size: 613K  
Words processed: 1900K     Vocab size: 637K  
Words processed: 2000K     Vocab size: 661K  
Words processed: 2100K     Vocab size: 684K  
Words processed: 2200K     Vocab size: 706K  
Words processed: 2300K     Vocab size: 729K  
Words processed: 2400K     Vocab size: 750K  
Words processed: 2500K     Vocab size: 771K  
Words processed: 2600K     Vocab size: 792K  
Words processed: 2700K     Vocab size: 813K  
Words processed: 2800K     Vocab size: 834K  
Words processed: 2900K     Vocab size: 854K  
Words processed: 3000K     Vocab size: 873K  
Words processed: 3100K     Vocab size: 893K  
Words processed: 3200K     Vocab size: 913K  
Words processed: 3300K     Vocab size: 932K  
Words processed: 3400K     Vocab size: 951K  
Words processed: 3500K     Vocab size: 970K  
Words processed: 3600K     Vocab size: 989K  
Words processed: 3700K     Vocab size: 1007K  
Words processed: 3800K     Vocab size: 1026K  
Words processed: 3900K     Vocab size: 1044K  
Words processed: 4000K     Vocab size: 1062K  
Words processed: 4100K     Vocab size: 1080K  
Words processed: 4200K     Vocab size: 1098K  
Words processed: 4300K     Vocab size: 1115K  
Words processed: 4400K     Vocab size: 1132K  
Words processed: 4500K     Vocab size: 1150K  
Words processed: 4600K     Vocab size: 1167K  
Words processed: 4700K     Vocab size: 1184K  
Words processed: 4800K     Vocab size: 1201K  
Words processed: 4900K     Vocab size: 1218K  
Words processed: 5000K     Vocab size: 1235K  
Words processed: 5100K     Vocab size: 1252K  
Words processed: 5200K     Vocab size: 1268K  
Words processed: 5300K     Vocab size: 1285K  
Words processed: 5400K     Vocab size: 1301K  
Words processed: 5500K     Vocab size: 1317K  
Words processed: 5600K     Vocab size: 1333K  
Words processed: 5700K     Vocab size: 1349K  
Words processed: 5800K     Vocab size: 1364K  
Words processed: 5900K     Vocab size: 1380K  
Words processed: 6000K     Vocab size: 1395K  
Words processed: 6100K     Vocab size: 1411K  
Words processed: 6200K     Vocab size: 1426K  
Words processed: 6300K     Vocab size: 1441K  
Words processed: 6400K     Vocab size: 1456K  
Words processed: 6500K     Vocab size: 1471K  
Words processed: 6600K     Vocab size: 1486K  
Words processed: 6700K     Vocab size: 1501K  
Words processed: 6800K     Vocab size: 1516K  
Words processed: 6900K     Vocab size: 1530K  
Words processed: 7000K     Vocab size: 1545K  
Words processed: 7100K     Vocab size: 1560K  
Words processed: 7200K     Vocab size: 1575K  
Words processed: 7300K     Vocab size: 1589K  
Words processed: 7400K     Vocab size: 1604K  
Words processed: 7500K     Vocab size: 1618K  
Words processed: 7600K     Vocab size: 1632K  
Words processed: 7700K     Vocab size: 1646K  
Words processed: 7800K     Vocab size: 1661K  
Words processed: 7900K     Vocab size: 1675K  
Words processed: 8000K     Vocab size: 1689K  
Words processed: 8100K     Vocab size: 1703K  
Words processed: 8200K     Vocab size: 1717K  
Words processed: 8300K     Vocab size: 1731K  
Words processed: 8400K     Vocab size: 1744K  
Words processed: 8500K     Vocab size: 1758K  
Words processed: 8600K     Vocab size: 1771K  
Words processed: 8700K     Vocab size: 1785K  
Words processed: 8800K     Vocab size: 1798K  
Words processed: 8900K     Vocab size: 1812K  
Words processed: 9000K     Vocab size: 1825K  
Words processed: 9100K     Vocab size: 1839K  
Words processed: 9200K     Vocab size: 1852K  
Words processed: 9300K     Vocab size: 1865K  
Words processed: 9400K     Vocab size: 1878K  
Words processed: 9500K     Vocab size: 1892K  
Words processed: 9600K     Vocab size: 1905K  
Words processed: 9700K     Vocab size: 1918K  
Words processed: 9800K     Vocab size: 1931K  
Words processed: 9900K     Vocab size: 1943K  
Words processed: 10000K     Vocab size: 1956K  
Words processed: 10100K     Vocab size: 1969K  
Words processed: 10200K     Vocab size: 1982K  
Words processed: 10300K     Vocab size: 1995K  
Words processed: 10400K     Vocab size: 2008K  
Words processed: 10500K     Vocab size: 2020K  
Words processed: 10600K     Vocab size: 2033K  
Words processed: 10700K     Vocab size: 2045K  
Words processed: 10800K     Vocab size: 2057K  
Words processed: 10900K     Vocab size: 2070K  
Words processed: 11000K     Vocab size: 2082K  
Words processed: 11100K     Vocab size: 2094K  
Words processed: 11200K     Vocab size: 2107K  
Words processed: 11300K     Vocab size: 2119K  
Words processed: 11400K     Vocab size: 2131K  
Words processed: 11500K     Vocab size: 2143K  
Words processed: 11600K     Vocab size: 2156K  
Words processed: 11700K     Vocab size: 2168K  
Words processed: 11800K     Vocab size: 2180K  
Words processed: 11900K     Vocab size: 2192K  
Words processed: 12000K     Vocab size: 2204K  
Words processed: 12100K     Vocab size: 2216K  
Words processed: 12200K     Vocab size: 2227K  
Words processed: 12300K     Vocab size: 2239K  
Words processed: 12400K     Vocab size: 2251K  
Words processed: 12500K     Vocab size: 2263K  
Words processed: 12600K     Vocab size: 2274K  
Words processed: 12700K     Vocab size: 2286K  
Words processed: 12800K     Vocab size: 2298K  
Words processed: 12900K     Vocab size: 2310K  
Words processed: 13000K     Vocab size: 2321K  
Words processed: 13100K     Vocab size: 2333K  
Words processed: 13200K     Vocab size: 2344K  
Words processed: 13300K     Vocab size: 2355K  
Words processed: 13400K     Vocab size: 2367K  
Words processed: 13500K     Vocab size: 2378K  
Words processed: 13600K     Vocab size: 2390K  
Words processed: 13700K     Vocab size: 2401K  
Words processed: 13800K     Vocab size: 2412K  
Words processed: 13900K     Vocab size: 2424K  
Words processed: 14000K     Vocab size: 2435K  
Words processed: 14100K     Vocab size: 2446K  
Words processed: 14200K     Vocab size: 2457K  
Words processed: 14300K     Vocab size: 2469K  
Words processed: 14400K     Vocab size: 2479K  
Words processed: 14500K     Vocab size: 2490K  
Words processed: 14600K     Vocab size: 2502K  
Words processed: 14700K     Vocab size: 2513K  
Words processed: 14800K     Vocab size: 2524K  
Words processed: 14900K     Vocab size: 2535K  
Words processed: 15000K     Vocab size: 2546K  
Words processed: 15100K     Vocab size: 2557K  
Words processed: 15200K     Vocab size: 2568K  
Words processed: 15300K     Vocab size: 2579K  
Words processed: 15400K     Vocab size: 2590K  
Words processed: 15500K     Vocab size: 2600K  
Words processed: 15600K     Vocab size: 2611K  
Words processed: 15700K     Vocab size: 2622K  
Words processed: 15800K     Vocab size: 2633K  
Words processed: 15900K     Vocab size: 2644K  
Words processed: 16000K     Vocab size: 2654K  
Words processed: 16100K     Vocab size: 2665K  
Words processed: 16200K     Vocab size: 2676K  
Words processed: 16300K     Vocab size: 2687K  
Words processed: 16400K     Vocab size: 2697K  
Words processed: 16500K     Vocab size: 2708K  
Words processed: 16600K     Vocab size: 2719K  
Words processed: 16700K     Vocab size: 2729K  
Words processed: 16800K     Vocab size: 2739K  
Words processed: 16900K     Vocab size: 2750K  
Words processed: 17000K     Vocab size: 2760K  
Words processed: 17100K     Vocab size: 2771K  
Words processed: 17200K     Vocab size: 2781K  
Words processed: 17300K     Vocab size: 2792K  
Words processed: 17400K     Vocab size: 2802K  
Words processed: 17500K     Vocab size: 2813K  
Words processed: 17600K     Vocab size: 2823K  
Words processed: 17700K     Vocab size: 2833K  
Words processed: 17800K     Vocab size: 2844K  
Words processed: 17900K     Vocab size: 2854K  
Words processed: 18000K     Vocab size: 2864K  
Words processed: 18100K     Vocab size: 2875K  
Words processed: 18200K     Vocab size: 2885K  
Words processed: 18300K     Vocab size: 2896K  
Words processed: 18400K     Vocab size: 2906K  
Words processed: 18500K     Vocab size: 2916K  
Words processed: 18600K     Vocab size: 2926K  
Words processed: 18700K     Vocab size: 2936K  
Words processed: 18800K     Vocab size: 2946K  
Words processed: 18900K     Vocab size: 2956K  
Words processed: 19000K     Vocab size: 2966K  
Words processed: 19100K     Vocab size: 2975K  
Words processed: 19200K     Vocab size: 2986K  
Words processed: 19300K     Vocab size: 2995K  
Words processed: 19400K     Vocab size: 3005K  
Words processed: 19500K     Vocab size: 3015K  
Words processed: 19600K     Vocab size: 3025K  
Words processed: 19700K     Vocab size: 3035K  
Words processed: 19800K     Vocab size: 3045K  
Words processed: 19900K     Vocab size: 3055K  
Words processed: 20000K     Vocab size: 3065K  
Words processed: 20100K     Vocab size: 3075K  
Words processed: 20200K     Vocab size: 3085K  
Words processed: 20300K     Vocab size: 3095K  
Words processed: 20400K     Vocab size: 3104K  
Words processed: 20500K     Vocab size: 3114K  
Words processed: 20600K     Vocab size: 3124K  
Words processed: 20700K     Vocab size: 3133K  
Words processed: 20800K     Vocab size: 3143K  
Words processed: 20900K     Vocab size: 3153K  
Words processed: 21000K     Vocab size: 3162K  
## Vocab size (unigrams + bigrams): 1814048
## Words in train file: 21011278
## Words written: 100K
Words written: 200K
Words written: 300K
Words written: 400K
Words written: 500K
Words written: 600K
Words written: 700K
Words written: 800K
Words written: 900K
Words written: 1000K
Words written: 1100K
Words written: 1200K
Words written: 1300K
Words written: 1400K
Words written: 1500K
Words written: 1600K
Words written: 1700K
Words written: 1800K
Words written: 1900K
Words written: 2000K
Words written: 2100K
Words written: 2200K
Words written: 2300K
Words written: 2400K
Words written: 2500K
Words written: 2600K
Words written: 2700K
Words written: 2800K
Words written: 2900K
Words written: 3000K
Words written: 3100K
Words written: 3200K
Words written: 3300K
Words written: 3400K
Words written: 3500K
Words written: 3600K
Words written: 3700K
Words written: 3800K
Words written: 3900K
Words written: 4000K
Words written: 4100K
Words written: 4200K
Words written: 4300K
Words written: 4400K
Words written: 4500K
Words written: 4600K
Words written: 4700K
Words written: 4800K
Words written: 4900K
Words written: 5000K
Words written: 5100K
Words written: 5200K
Words written: 5300K
Words written: 5400K
Words written: 5500K
Words written: 5600K
Words written: 5700K
Words written: 5800K
Words written: 5900K
Words written: 6000K
Words written: 6100K
Words written: 6200K
Words written: 6300K
Words written: 6400K
Words written: 6500K
Words written: 6600K
Words written: 6700K
Words written: 6800K
Words written: 6900K
Words written: 7000K
Words written: 7100K
Words written: 7200K
Words written: 7300K
Words written: 7400K
Words written: 7500K
Words written: 7600K
Words written: 7700K
Words written: 7800K
Words written: 7900K
Words written: 8000K
Words written: 8100K
Words written: 8200K
Words written: 8300K
Words written: 8400K
Words written: 8500K
Words written: 8600K
Words written: 8700K
Words written: 8800K
Words written: 8900K
Words written: 9000K
Words written: 9100K
Words written: 9200K
Words written: 9300K
Words written: 9400K
Words written: 9500K
Words written: 9600K
Words written: 9700K
Words written: 9800K
Words written: 9900K
Words written: 10000K
Words written: 10100K
Words written: 10200K
Words written: 10300K
Words written: 10400K
Words written: 10500K
Words written: 10600K
Words written: 10700K
Words written: 10800K
Words written: 10900K
Words written: 11000K
Words written: 11100K
Words written: 11200K
Words written: 11300K
Words written: 11400K
Words written: 11500K
Words written: 11600K
Words written: 11700K
Words written: 11800K
Words written: 11900K
Words written: 12000K
Words written: 12100K
Words written: 12200K
Words written: 12300K
Words written: 12400K
Words written: 12500K
Words written: 12600K
Words written: 12700K
Words written: 12800K
Words written: 12900K
Words written: 13000K
Words written: 13100K
Words written: 13200K
Words written: 13300K
Words written: 13400K
Words written: 13500K
Words written: 13600K
Words written: 13700K
Words written: 13800K
Words written: 13900K
Words written: 14000K
Words written: 14100K
Words written: 14200K
Words written: 14300K
Words written: 14400K
Words written: 14500K
Words written: 14600K
Words written: 14700K
Words written: 14800K
Words written: 14900K
Words written: 15000K
Words written: 15100K
Words written: 15200K
Words written: 15300K
Words written: 15400K
Words written: 15500K
Words written: 15600K
Words written: 15700K
Words written: 15800K
Words written: 15900K
Words written: 16000K
Words written: 16100K
Words written: 16200K
Words written: 16300K
Words written: 16400K
Words written: 16500K
Words written: 16600K
Words written: 16700K
Words written: 16800K
Words written: 16900K
Words written: 17000K
Words written: 17100K
Words written: 17200K
Words written: 17300K
Words written: 17400K
Words written: 17500K
Words written: 17600K
Words written: 17700K
Words written: 17800K
Words written: 17900K
Words written: 18000K
Words written: 18100K
Words written: 18200K
Words written: 18300K
Words written: 18400K
Words written: 18500K
Words written: 18600K
Words written: 18700K
Words written: 18800K
Words written: 18900K
Words written: 19000K
Words written: 19100K
Words written: 19200K
Words written: 19300K
Words written: 19400K
Words written: 19500K
Words written: 19600K
Words written: 19700K
Words written: 19800K
Words written: 19900K
Words written: 20000K
Words written: 20100K
Words written: 20200K
Words written: 20300K
Words written: 20400K
Words written: 20500K
Words written: 20600K
Words written: 20700K
Words written: 20800K
Words written: 20900K
Words written: 21000K</code></pre>
<div class="sourceCode" id="cb905"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb905-1"><a href="representación-de-palabras-y-word2vec.html#cb905-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">&quot;./salidas/noticias_vectors.bin&quot;</span>)) {</span>
<span id="cb905-2"><a href="representación-de-palabras-y-word2vec.html#cb905-2" aria-hidden="true" tabindex="-1"></a>  modelo <span class="ot">&lt;-</span> <span class="fu">train_word2vec</span>(<span class="st">&quot;./salidas/noticias_w2v.txt&quot;</span>, </span>
<span id="cb905-3"><a href="representación-de-palabras-y-word2vec.html#cb905-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;./salidas/noticias_vectors.bin&quot;</span>,</span>
<span id="cb905-4"><a href="representación-de-palabras-y-word2vec.html#cb905-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">vectors =</span> <span class="dv">100</span>, <span class="at">threads =</span> <span class="dv">8</span>, <span class="at">window =</span> <span class="dv">4</span>, <span class="at">cbow =</span> <span class="dv">0</span>,  </span>
<span id="cb905-5"><a href="representación-de-palabras-y-word2vec.html#cb905-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">iter =</span> <span class="dv">20</span>, <span class="at">negative_samples =</span> <span class="dv">20</span>, <span class="at">min_count =</span> <span class="dv">10</span>) </span>
<span id="cb905-6"><a href="representación-de-palabras-y-word2vec.html#cb905-6" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb905-7"><a href="representación-de-palabras-y-word2vec.html#cb905-7" aria-hidden="true" tabindex="-1"></a>  modelo <span class="ot">&lt;-</span> <span class="fu">read.vectors</span>(<span class="st">&quot;./salidas/noticias_vectors.bin&quot;</span>)</span>
<span id="cb905-8"><a href="representación-de-palabras-y-word2vec.html#cb905-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>El resultado son los vectores aprendidos de las palabras, por ejemplo</p>
<div class="sourceCode" id="cb906"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb906-1"><a href="representación-de-palabras-y-word2vec.html#cb906-1" aria-hidden="true" tabindex="-1"></a>vector_gol <span class="ot">&lt;-</span> modelo[[<span class="st">&quot;gol&quot;</span>]] <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb906-2"><a href="representación-de-palabras-y-word2vec.html#cb906-2" aria-hidden="true" tabindex="-1"></a>vector_gol</span></code></pre></div>
<pre><code>##   [1] -0.389627248  0.048135430  0.501164794 -0.035961468  0.291238993
##   [6]  0.642733335 -0.386596769  0.281559557 -0.199183896 -0.554564893
##  [11]  0.451201737  0.495587140 -0.525584400  0.166191801 -0.180947676
##  [16]  0.034590811  0.731496751  0.259901792 -0.201457486 -0.308042079
##  [21] -0.177875623 -0.220428273  0.408699900  0.001920983  0.011449666
##  [26] -0.718980432  0.153631359 -0.049470965  0.981541216  0.082757361
##  [31] -0.331263602  0.458369821 -0.429754555  0.128275126 -0.421742797
##  [36]  0.596242130 -0.093633644  0.066455603 -0.016802812 -0.301688135
##  [41]  0.079358041  0.446704596 -0.244078919 -0.137954682  0.695054173
##  [46]  0.335903019  0.216709450  0.604890466 -0.538004100 -0.291783333
##  [51] -0.579949379 -0.048889056  0.324184030 -0.055591993 -0.012452535
##  [56] -0.200338170  0.254620761  0.082836255  0.389545202 -0.185363784
##  [61] -0.021011911  0.307440221  0.415608138  0.248776823 -0.139897019
##  [66]  0.008641024  0.235776618  0.324411124 -0.171800703  0.131596789
##  [71] -0.163520932  0.370538741 -0.134094939 -0.193797469 -0.543500543
##  [76]  0.312639445 -0.172534481 -0.115350038 -0.293528855 -0.534602344
##  [81]  0.515545666  0.708557248  0.444676250 -0.054800753  0.388787180
##  [86]  0.483029991  0.281573176  0.434132993  0.441057146 -0.347387016
##  [91] -0.174339339  0.060069371 -0.034651209  0.407196820  0.661161661
##  [96]  0.261399239 -0.089392163 -0.043052837 -0.539683878  0.105241157</code></pre>
</div>
</div>
<div id="esprep" class="section level2" number="10.4">
<h2><span class="header-section-number">10.4</span> Espacio de representación de palabras</h2>
<p>Como discutimos arriba, palabras que se usan en contextos
similares por su significado o por su función (por ejemplo, “perro” y “gato”“) deben tener representaciones similares, pues su contexto tiende a ser similar. <strong>La similitud que usamos el similitud coseno</strong>.</p>
<p>Podemos verificar con nuestro ejemplo:</p>
<div class="sourceCode" id="cb908"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb908-1"><a href="representación-de-palabras-y-word2vec.html#cb908-1" aria-hidden="true" tabindex="-1"></a>ejemplos <span class="ot">&lt;-</span> modelo <span class="sc">|&gt;</span>  <span class="fu">closest_to</span>(<span class="st">&quot;gol&quot;</span>, <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb908-2"><a href="representación-de-palabras-y-word2vec.html#cb908-2" aria-hidden="true" tabindex="-1"></a>ejemplos</span></code></pre></div>
<pre><code>##              word similarity to &quot;gol&quot;
## 1             gol           1.0000000
## 2          golazo           0.8252912
## 3     segundo_gol           0.7978025
## 4         penalti           0.7764458
## 5 potente_disparo           0.7755037</code></pre>
<p>También podríamos calcular manualmente:</p>
<p>Que también podemos calcular como:</p>
<div class="sourceCode" id="cb910"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb910-1"><a href="representación-de-palabras-y-word2vec.html#cb910-1" aria-hidden="true" tabindex="-1"></a>vector_penalti <span class="ot">&lt;-</span> modelo[[<span class="st">&quot;penalti&quot;</span>]] <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb910-2"><a href="representación-de-palabras-y-word2vec.html#cb910-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cosineSimilarity</span>(modelo[[<span class="st">&quot;gol&quot;</span>]], modelo[[<span class="st">&quot;penalti&quot;</span>]])</span></code></pre></div>
<pre><code>##           [,1]
## [1,] 0.7764458</code></pre>
<p>O directamente:</p>
<div class="sourceCode" id="cb912"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb912-1"><a href="representación-de-palabras-y-word2vec.html#cb912-1" aria-hidden="true" tabindex="-1"></a>norma <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sqrt</span>(<span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb912-2"><a href="representación-de-palabras-y-word2vec.html#cb912-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(vector_gol <span class="sc">*</span> vector_penalti) <span class="sc">/</span> (<span class="fu">norma</span>(vector_gol) <span class="sc">*</span> <span class="fu">norma</span>(vector_penalti))</span></code></pre></div>
<pre><code>## [1] 0.7764458</code></pre>
<div id="geometría-en-el-espacio-de-representaciones" class="section level3 unnumbered">
<h3>Geometría en el espacio de representaciones</h3>
<p>Ahora consideremos cómo se distribuyen las palabras en este
espacio, y si existe estructura geométrica en este espacio que tenga
información acerca del lenguaje.</p>
<p>Consideremos primero el caso de plurales de sustantivos.</p>
<ul>
<li>Como el contexto de los plurales es distinto de los singulares,
nuestro modelo debería poder capturar en los vectores su diferencia.</li>
<li>Examinamos entonces cómo son geométricamente
diferentes las representaciones de plurales vs singulares</li>
<li>Si encontramos un patrón reconocible, podemos utilizar este patrón, por ejemplo,
para encontrar la versión plural de una palabra singular, <em>sin usar ninguna
regla del lenguaje</em>.</li>
</ul>
<p>Una de las relaciones geométricas más simples es la adición de vectores. Por ejemplo,
extraemos la diferencia entre gol y goles:</p>
<div class="sourceCode" id="cb914"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb914-1"><a href="representación-de-palabras-y-word2vec.html#cb914-1" aria-hidden="true" tabindex="-1"></a>ejemplos <span class="ot">&lt;-</span> modelo <span class="sc">|&gt;</span>  <span class="fu">closest_to</span>(<span class="st">&quot;dos&quot;</span>, <span class="at">n =</span> <span class="dv">15</span>)</span>
<span id="cb914-2"><a href="representación-de-palabras-y-word2vec.html#cb914-2" aria-hidden="true" tabindex="-1"></a>ejemplos</span></code></pre></div>
<pre><code>##       word similarity to &quot;dos&quot;
## 1      dos           1.0000000
## 2     tres           0.9666800
## 3   cuatro           0.9527403
## 4    cinco           0.9205234
## 5    siete           0.9024807
## 6     seis           0.8977667
## 7     ocho           0.8879153
## 8    nueve           0.8550580
## 9    trece           0.8514542
## 10 catorce           0.8321762
## 11    diez           0.8133345
## 12  quince           0.8102052
## 13    doce           0.8085939
## 14    once           0.8033385
## 15  veinte           0.7814970</code></pre>
<div class="sourceCode" id="cb916"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb916-1"><a href="representación-de-palabras-y-word2vec.html#cb916-1" aria-hidden="true" tabindex="-1"></a>ejemplos <span class="ot">&lt;-</span> modelo <span class="sc">|&gt;</span>  <span class="fu">closest_to</span>(<span class="fu">c</span>(<span class="st">&quot;lluvioso&quot;</span>), <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb916-2"><a href="representación-de-palabras-y-word2vec.html#cb916-2" aria-hidden="true" tabindex="-1"></a>ejemplos</span></code></pre></div>
<pre><code>##       word similarity to c(&quot;lluvioso&quot;)
## 1 lluvioso                   1.0000000
## 2 caluroso                   0.8041209
## 3   cálido                   0.6896448
## 4   húmedo                   0.6866749
## 5   gélido                   0.6660152</code></pre>
<div class="sourceCode" id="cb918"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb918-1"><a href="representación-de-palabras-y-word2vec.html#cb918-1" aria-hidden="true" tabindex="-1"></a>ejemplos <span class="ot">&lt;-</span> modelo <span class="sc">|&gt;</span>  <span class="fu">closest_to</span>(<span class="st">&quot;presidente&quot;</span>, <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb918-2"><a href="representación-de-palabras-y-word2vec.html#cb918-2" aria-hidden="true" tabindex="-1"></a>ejemplos</span></code></pre></div>
<pre><code>##                   word similarity to &quot;presidente&quot;
## 1           presidente                  1.0000000
## 2       vicepresidente                  0.8412900
## 3        ex_presidente                  0.8321029
## 4 máximo_representante                  0.7781001
## 5     máximo_dirigente                  0.7629962</code></pre>
<div class="sourceCode" id="cb920"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb920-1"><a href="representación-de-palabras-y-word2vec.html#cb920-1" aria-hidden="true" tabindex="-1"></a>ejemplos <span class="ot">&lt;-</span> modelo <span class="sc">|&gt;</span>  <span class="fu">closest_to</span>(<span class="st">&quot;parís&quot;</span>, <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb920-2"><a href="representación-de-palabras-y-word2vec.html#cb920-2" aria-hidden="true" tabindex="-1"></a>ejemplos</span></code></pre></div>
<pre><code>##         word similarity to &quot;parís&quot;
## 1      parís             1.0000000
## 2    londres             0.9232452
## 3 nueva_york             0.8464673
## 4       roma             0.8443222
## 5     berlín             0.8081766</code></pre>
<p>Y vemos, por ejemplo, que el modelo puede capturar conceptos relacionados
con el estado del clima, capitales de países y números - aún cuando no hemos
anotado estas funciones en el corpus original. Estos vectores son similares
porque tienden a ocurrir en contextos similares.</p>
</div>
<div id="geometría-en-el-espacio-de-representaciones-1" class="section level3 unnumbered">
<h3>Geometría en el espacio de representaciones</h3>
<p>Ahora consideremos cómo se distribuyen las palabras en este
espacio, y si existe estructura geométrica en este espacio que tenga
información acerca del lenguaje.</p>
<p>Consideremos primero el caso de plurales de sustantivos.</p>
<ul>
<li>Como el contexto de los plurales es distinto de los singulares,
nuestro modelo debería poder capturar en los vectores su diferencia.</li>
<li>Examinamos entonces cómo son geométricamente
diferentes las representaciones de plurales vs singulares</li>
<li>Si encontramos un patrón reconocible, podemos utilizar este patrón, por ejemplo,
para encontrar la versión plural de una palabra singular, <em>sin usar ninguna
regla del lenguaje</em>.</li>
</ul>
<p>Una de las relaciones geométricas más simples es la adición de vectores. Por ejemplo,
extraemos la diferencia entre gol y goles:</p>
<div class="sourceCode" id="cb922"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb922-1"><a href="representación-de-palabras-y-word2vec.html#cb922-1" aria-hidden="true" tabindex="-1"></a>plural_1 <span class="ot">&lt;-</span> modelo[[<span class="st">&quot;goles&quot;</span>]] <span class="sc">-</span> modelo[[<span class="st">&quot;gol&quot;</span>]]</span>
<span id="cb922-2"><a href="representación-de-palabras-y-word2vec.html#cb922-2" aria-hidden="true" tabindex="-1"></a>plural_1</span></code></pre></div>
<pre><code>## A VectorSpaceModel object of  1  words and  100  vectors
##            [,1]       [,2]        [,3]       [,4]        [,5]       [,6]
## [1,] -0.2301596 -0.2543171 -0.04071745 -0.2292878 0.004059255 -0.2283908
## attr(,&quot;.cache&quot;)
## &lt;environment: 0x55e163dcd6b8&gt;</code></pre>
<p>que es un vector en el espacio de representación de palabras. Ahora sumamos este vector
a un sustantivo en singular, y vemos qué palabras están cercas de esta “palabra sintética”:</p>
<div class="sourceCode" id="cb924"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb924-1"><a href="representación-de-palabras-y-word2vec.html#cb924-1" aria-hidden="true" tabindex="-1"></a>vector <span class="ot">&lt;-</span>  modelo[[<span class="st">&quot;partido&quot;</span>]] <span class="sc">+</span> plural_1</span>
<span id="cb924-2"><a href="representación-de-palabras-y-word2vec.html#cb924-2" aria-hidden="true" tabindex="-1"></a>modelo <span class="sc">|&gt;</span> <span class="fu">closest_to</span>(vector, <span class="at">n =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## Warning in if (class(formula) == &quot;formula&quot;) {: the condition has length &gt; 1 and
## only the first element will be used</code></pre>
<pre><code>## Warning in if (class(object) == &quot;VectorSpaceModel&quot;) {: the condition has length
## &gt; 1 and only the first element will be used</code></pre>
<pre><code>##                  word similarity to vector
## 1            partidos            0.7961097
## 2               goles            0.7589920
## 3 partidos_disputados            0.6937101
## 4  últimos_encuentros            0.6788752
## 5          encuentros            0.6697611</code></pre>
<p>Nótese que la más cercana es justamente el plural correcto, o otros plurales con relación
al que buscábamos (como <em>encuentros</em>)</p>
<p>Otro ejemplo:</p>
<div class="sourceCode" id="cb928"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb928-1"><a href="representación-de-palabras-y-word2vec.html#cb928-1" aria-hidden="true" tabindex="-1"></a>plural_1 <span class="ot">&lt;-</span> modelo[[<span class="st">&quot;días&quot;</span>]] <span class="sc">-</span> modelo[[<span class="st">&quot;día&quot;</span>]]</span>
<span id="cb928-2"><a href="representación-de-palabras-y-word2vec.html#cb928-2" aria-hidden="true" tabindex="-1"></a>vector <span class="ot">&lt;-</span>  modelo[[<span class="st">&quot;mes&quot;</span>]] <span class="sc">+</span> plural_1</span>
<span id="cb928-3"><a href="representación-de-palabras-y-word2vec.html#cb928-3" aria-hidden="true" tabindex="-1"></a>modelo <span class="sc">|&gt;</span>  <span class="fu">closest_to</span>(vector, <span class="at">n =</span> <span class="dv">20</span>) </span></code></pre></div>
<pre><code>## Warning in if (class(formula) == &quot;formula&quot;) {: the condition has length &gt; 1 and
## only the first element will be used</code></pre>
<pre><code>## Warning in if (class(object) == &quot;VectorSpaceModel&quot;) {: the condition has length
## &gt; 1 and only the first element will be used</code></pre>
<pre><code>##                word similarity to vector
## 1        tres_meses            0.7858109
## 2              días            0.7708776
## 3             meses            0.7655628
## 4         diez_días            0.7199002
## 5        seis_meses            0.7110105
## 6       quince_días            0.7092209
## 7       nueve_meses            0.6903626
## 8        doce_meses            0.6887811
## 9               mes            0.6785786
## 10         18_meses            0.6483637
## 11         48_horas            0.6392776
## 12        diez_años            0.6365554
## 13             años            0.6339559
## 14          semanas            0.6284049
## 15      quince_años            0.6281021
## 16      dos_semanas            0.6147185
## 17       trimestres            0.6012591
## 18     días_hábiles            0.5972889
## 19 veinticinco_años            0.5955164
## 20     nueves_meses            0.5947687</code></pre>
<p>Veremos ahora cómo funciona para el género de sustantivos:</p>
<div class="sourceCode" id="cb932"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb932-1"><a href="representación-de-palabras-y-word2vec.html#cb932-1" aria-hidden="true" tabindex="-1"></a>fem_1 <span class="ot">&lt;-</span> modelo[[<span class="st">&quot;presidenta&quot;</span>]] <span class="sc">-</span> modelo[[<span class="st">&quot;presidente&quot;</span>]]</span>
<span id="cb932-2"><a href="representación-de-palabras-y-word2vec.html#cb932-2" aria-hidden="true" tabindex="-1"></a>vector <span class="ot">&lt;-</span>  modelo[[<span class="st">&quot;rey&quot;</span>]] <span class="sc">+</span> fem_1</span>
<span id="cb932-3"><a href="representación-de-palabras-y-word2vec.html#cb932-3" aria-hidden="true" tabindex="-1"></a>modelo <span class="sc">|&gt;</span>  <span class="fu">closest_to</span>(vector, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(word <span class="sc">!=</span> <span class="st">&quot;rey&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in if (class(formula) == &quot;formula&quot;) {: the condition has length &gt; 1 and
## only the first element will be used</code></pre>
<pre><code>## Warning in if (class(object) == &quot;VectorSpaceModel&quot;) {: the condition has length
## &gt; 1 and only the first element will be used</code></pre>
<pre><code>##       word similarity to vector
## 1    reina            0.7402226
## 2 princesa            0.6662326
## 3      pía            0.6249812
## 4    perla            0.6189366</code></pre>
<div class="sourceCode" id="cb936"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb936-1"><a href="representación-de-palabras-y-word2vec.html#cb936-1" aria-hidden="true" tabindex="-1"></a>vector <span class="ot">&lt;-</span>  modelo[[<span class="st">&quot;tío&quot;</span>]] <span class="sc">+</span> fem_1</span>
<span id="cb936-2"><a href="representación-de-palabras-y-word2vec.html#cb936-2" aria-hidden="true" tabindex="-1"></a>modelo <span class="sc">|&gt;</span>  <span class="fu">closest_to</span>(vector, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(word <span class="sc">!=</span> <span class="st">&quot;tío&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in if (class(formula) == &quot;formula&quot;) {: the condition has length &gt; 1 and
## only the first element will be used</code></pre>
<pre><code>## Warning in if (class(object) == &quot;VectorSpaceModel&quot;) {: the condition has length
## &gt; 1 and only the first element will be used</code></pre>
<pre><code>##      word similarity to vector
## 1   dueña            0.7036596
## 2 hermana            0.6947787
## 3  abuela            0.6871846
## 4     tía            0.6850960</code></pre>
</div>
<div id="evaluación-de-calidad-de-modelos" class="section level3 unnumbered">
<h3>Evaluación de calidad de modelos</h3>
<p>La evaluación de estas aplicaciones puede hacerse por ejemplo, con tareas de analogía,
con listas de singular/plurales, de adjetivos/adverbios, masculino/femenino, etc (ver <span class="citation">(<a href="#ref-word2vec" role="doc-biblioref">Mikolov et al. 2013</a>)</span>),
(ver por ejemplo <a href="https://github.com/tmikolov/word2vec/blob/master/questions-words.txt" class="uri">https://github.com/tmikolov/word2vec/blob/master/questions-words.txt</a>). Adicionalmente,
si se utilizan en alguna tarea <em>downstream</em>, pueden evaluarse en el desempeño de esa
tarea particular.</p>
<p><strong>Ejercicio</strong>: ¿cómo usarías esta geometría para encontrar el país en el que está una capital dada?</p>
<p><strong>Observación</strong>: falta afinar los parámetros en este modelo.
Puedes probar cambiando negative sampling (por ejemplo, incrementa a 40), el número de vectores (50-200, por ejemplo), e incrementando <em>window</em> y el número de iteraciones.</p>
<p>Considera también un modelo preentrenado mucho más grande como <a href="https://github.com/uchile-nlp/spanish-word-embeddings">este</a>. Puedes bajar los vectores de palabras
y repetir las tareas mostradas (el formato bin es estándar para la implementación que usamos de word2vec).</p>
<hr />
<p>Podemos visualizar el espacio de representaciones reduciendo dimensionalidad. En este caso, utilizamos <em>tsne</em>:</p>
<div class="sourceCode" id="cb940"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb940-1"><a href="representación-de-palabras-y-word2vec.html#cb940-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tsne)</span>
<span id="cb940-2"><a href="representación-de-palabras-y-word2vec.html#cb940-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb940-3"><a href="representación-de-palabras-y-word2vec.html#cb940-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb940-4"><a href="representación-de-palabras-y-word2vec.html#cb940-4" aria-hidden="true" tabindex="-1"></a>mat_vs <span class="ot">&lt;-</span> modelo<span class="sc">@</span>.Data</span>
<span id="cb940-5"><a href="representación-de-palabras-y-word2vec.html#cb940-5" aria-hidden="true" tabindex="-1"></a><span class="co"># solo calculamos para las 500 palabras más comunes</span></span>
<span id="cb940-6"><a href="representación-de-palabras-y-word2vec.html#cb940-6" aria-hidden="true" tabindex="-1"></a>num_palabras <span class="ot">&lt;-</span> <span class="dv">500</span> </span>
<span id="cb940-7"><a href="representación-de-palabras-y-word2vec.html#cb940-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1203</span>)</span>
<span id="cb940-8"><a href="representación-de-palabras-y-word2vec.html#cb940-8" aria-hidden="true" tabindex="-1"></a>vs_2 <span class="ot">&lt;-</span> <span class="fu">tsne</span>(mat_vs[<span class="dv">1</span><span class="sc">:</span>num_palabras, ], </span>
<span id="cb940-9"><a href="representación-de-palabras-y-word2vec.html#cb940-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">max_iter =</span> <span class="dv">1000</span>, <span class="at">perplexity =</span> <span class="dv">50</span>)</span></code></pre></div>
<pre><code>## Warning in if (class(X) == &quot;dist&quot;) {: the condition has length &gt; 1 and only the
## first element will be used</code></pre>
<pre><code>## sigma summary: Min. : 0.50676082427291 |1st Qu. : 0.659095357760454 |Median : 0.736635035661307 |Mean : 0.75791167716744 |3rd Qu. : 0.841790649429495 |Max. : 1.11657529954154 |</code></pre>
<pre><code>## Epoch: Iteration #100 error is: 19.2455766810395</code></pre>
<pre><code>## Epoch: Iteration #200 error is: 0.84088184930299</code></pre>
<pre><code>## Epoch: Iteration #300 error is: 0.808986014121995</code></pre>
<pre><code>## Epoch: Iteration #400 error is: 0.798502126441899</code></pre>
<pre><code>## Epoch: Iteration #500 error is: 0.79708951735216</code></pre>
<pre><code>## Epoch: Iteration #600 error is: 0.796517693130686</code></pre>
<pre><code>## Epoch: Iteration #700 error is: 0.796283474583645</code></pre>
<pre><code>## Epoch: Iteration #800 error is: 0.796006303282691</code></pre>
<pre><code>## Epoch: Iteration #900 error is: 0.795958873280288</code></pre>
<pre><code>## Epoch: Iteration #1000 error is: 0.795805321392407</code></pre>
<div class="sourceCode" id="cb953"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb953-1"><a href="representación-de-palabras-y-word2vec.html#cb953-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">823</span>)</span>
<span id="cb953-2"><a href="representación-de-palabras-y-word2vec.html#cb953-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(vs_2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;V1&quot;</span>, <span class="st">&quot;V2&quot;</span>)</span>
<span id="cb953-3"><a href="representación-de-palabras-y-word2vec.html#cb953-3" aria-hidden="true" tabindex="-1"></a>df_vs <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(vs_2, <span class="at">.name_repair =</span> <span class="st">&quot;check_unique&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb953-4"><a href="representación-de-palabras-y-word2vec.html#cb953-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">palabra =</span> <span class="fu">rownames</span>(mat_vs[<span class="dv">1</span><span class="sc">:</span>num_palabras, ]))</span>
<span id="cb953-5"><a href="representación-de-palabras-y-word2vec.html#cb953-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_vs <span class="sc">%&gt;%</span> <span class="fu">sample_n</span>(<span class="dv">250</span>), </span>
<span id="cb953-6"><a href="representación-de-palabras-y-word2vec.html#cb953-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">label =</span> palabra)) <span class="sc">+</span></span>
<span id="cb953-7"><a href="representación-de-palabras-y-word2vec.html#cb953-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb953-8"><a href="representación-de-palabras-y-word2vec.html#cb953-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">force =</span> <span class="fl">0.3</span>, <span class="at">segment.alpha =</span> <span class="fl">0.5</span>) </span></code></pre></div>
<pre><code>## Warning: ggrepel: 15 unlabeled data points (too many overlaps). Consider
## increasing max.overlaps</code></pre>
<p><img src="09-rep-distribuida-1_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
</div>
</div>
<div id="usos-de-representaciones-distribuidas" class="section level2" number="10.5">
<h2><span class="header-section-number">10.5</span> Usos de representaciones distribuidas</h2>
<p>La idea general de construir representaciones densas de las palabras
(en lugar de representaciones ralas, como codificación dummy o one-hot encoding) es una fundamental en varias tareas de procesamiento de lenguaje natural. Se utiliza en clasificación de textos (<em>fast-text</em> es similar
al modelo bag-of-words),
respuesta de preguntas, traducción automática, recuperación
de información, reconocimiento de entidades, etc. Word2vec también puede ser
usado para sistemas de recomendación (las palabras son artículos, las canastas son los textos).</p>
<ul>
<li>Puedes ver la implementación original junto con aplicaciones <a href="https://code.google.com/archive/p/word2vec/">aquí</a>, y <a href="https://github.com/tmikolov/word2vec">aquí</a>.</li>
<li>Un método similar es <a href="https://nlp.stanford.edu/projects/glove/">Glove</a>.</li>
</ul>

</div>
</div>
<h3>Referencias</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-bengio" class="csl-entry">
Bengio, Yoshua, Réjean Ducharme, Pascal Vincent, and Christian Janvin. 2003. <span>“A Neural Probabilistic Language Model.”</span> <em>J. Mach. Learn. Res.</em> 3 (March): 1137–55. <a href="http://dl.acm.org/citation.cfm?id=944919.944966">http://dl.acm.org/citation.cfm?id=944919.944966</a>.
</div>
<div id="ref-goodfellow" class="csl-entry">
Goodfellow, Ian, Yoshua Bengio, and Aaron Courville. 2016. <em>Deep Learning</em>. MIT Press.
</div>
<div id="ref-word2vec" class="csl-entry">
Mikolov, Tomas, Kai Chen, Greg Corrado, and Jeffrey Dean. 2013. <span>“Efficient Estimation of Word Representations in Vector Space.”</span> <em>CoRR</em> abs/1301.3781. <a href="http://arxiv.org/abs/1301.3781">http://arxiv.org/abs/1301.3781</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelos-de-lenguaje-y-n-gramas.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="t-sne-y-reducción-de-dimensionalidad.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/felipegonzalez/metodos-analiticos-mcd-2022/edit/master/notas/09-rep-distribuida-1.Rmd",
"text": "Editar"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
